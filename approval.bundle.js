(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"+UtQ":function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,".form-com[data-v-06b211f7]{margin-top:.12rem}.reasonContent-box[data-v-06b211f7]{height:1.23rem;background-color:#fff;padding:.13rem .15rem}.reasonContent-box>.textarea[data-v-06b211f7]{width:100%;height:100%;resize:none;border:none;outline:none}textarea[data-v-06b211f7]::-webkit-input-placeholder{color:#ccc;font-size:.14rem}textarea[data-v-06b211f7]:-ms-input-placeholder,textarea[data-v-06b211f7]::-ms-input-placeholder{color:#ccc;font-size:.14rem}textarea[data-v-06b211f7]::placeholder{color:#ccc;font-size:.14rem}",""])},"+azj":function(t,e,o){var a=o("Brzr");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("4b1d6e9c",a,!0,{})},"0vL0":function(t,e,o){"use strict";o.r(e);var a=o("lKpO"),i=o("ydf2"),n=o("p/l8"),r=o("8CNX"),s=o("hHQW"),c=o("8ffV"),l=o("KqdF"),m=o("cTMg"),d=o("kV9B"),p=o("6UnF"),u=o("xVKS"),f=o("k0ul"),h={components:{CommitBtnCom:r.a,ApprovalProcessCom:m.a,ccPersonCom:d.a,AttachmentCom:p.a,SlideSelectDate:i.a,BottomOptions:u.a,MemberSelect:n.a,TextareaCom:l.a,Cell:s.a,FormCom:c.a},data:function(){return{isXiLi:"",isCommited:!1,curUserId:"",durationNum:"",approvalPersonArr:[],canChangeProcess:!0,canChangeCcpeople:!0,ccPersonArr:[],leaveTypeList:[],SlideSelectDateShowA:!1,SlideSelectDateShowB:!1,typeId:"",typeName:"",dateSelA:"",dateSelB:"",textareaText:"",type:-1,imgList:[],fileList:[],attachmentList:[],isLoaded:!1,bottomOptionsShowA:0}},computed:{durationDay:function(){return this.durationNum/8}},watch:{typeId:function(){this.typeId&&this.durationNum&&this.getConf()},durationNum:function(){this.typeId&&this.durationNum&&this.getConf()},dateSelA:function(){if(this.dateSelA&&this.dateSelB){var t=this.dateSelA.split("  "),e=this.dateSelB.split("  "),o=new Date(t[0].replace(/(-)/g,"/")).getTime(),a=(new Date(e[0].replace(/(-)/g,"/")).getTime()-o)/1e3/60/60/24,i="上午"===t[1]?8:4,n="上午"===e[1]?4:8;this.durationNum=8*(a-1)+i+n}},dateSelB:function(){if(this.dateSelA&&this.dateSelB){var t=this.dateSelA.split("  "),e=this.dateSelB.split("  "),o=new Date(t[0].replace(/(-)/g,"/")).getTime(),a=(new Date(e[0].replace(/(-)/g,"/")).getTime()-o)/1e3/60/60/24,i="上午"===t[1]?8:4,n="上午"===e[1]?4:8;this.durationNum=8*(a-1)+i+n}}},created:function(){var t=this;this.getCurrUserInfo(),this.getLeaveType().then(function(e){t.leaveTypeList=e}),this.$route.params.id&&"0"!==this.$route.params.id&&(this.isEdit=!0,this.getApplicationDetails())},methods:{getCurrUserInfo:function(){var t=this;return this.$axios.get("/schoolorg/v1/getCurrUserInfo").then(function(e){var o=e.data;if(200===o.status){var a=o.result.data;return t.isXiLi="4892271197889314468"===a.campus_id,a}})},onMemberAction:function(t){this.$refs.vMemberSelect.show({onConfirm:function(e){0!==e.memberList.length&&(t.user_name=e.memberList[0].user_name,t.user_id=e.memberList[0].user_id)}})},onSelectDirector:function(t){this.$refs.vMemberSelect.show({staticData:t.leader_list,onConfirm:function(e){0!==e.memberList.length&&(t.user_name=e.memberList[0].user_name,t.user_id=e.memberList[0].user_id)}})},showMemberSelect:function(){var t=this;this.$refs.vMemberSelect.show({selectedData:{},onConfirm:function(e){if(0!==e.memberList.length){var o=t.approvalPersonArr.length;if(o&&t.approvalPersonArr[o-1].user_id===e.memberList[0].user_id)return t.$simpleMsg("该成员与上级重复"),!1;t.approvalPersonArr.push(e.memberList[0])}}})},timeError:function(t){this.$simpleMsg(t)},LeaveTypeAction:function(t){this.typeId=t.id,this.typeName=t.name,this.bottomOptionsShowA=!1},getApplicationDetails:function(){var t=this;this.$axios.get("/mobicampus/approve/v1/getApplicationDetails/"+this.$route.params.id).then(function(e){var o=e.data,a=o.result.data;if(200===o.status){var i=a.resource,n=a.process,r=a.application;t.formArr=[],t.curUserId=r.create_user_id;var s=i.start_time.split("+")[0].split("T"),c=i.end_time.split("+")[0].split("T");s[1]="07:50:00"===s[1]?"上午":"下午",c[1]="12:00:00"===c[1]?"上午":"下午",t.typeName=i.type_name,t.typeId=i.type_id,t.dateSelA=s[0]+"  "+s[1],t.dateSelB=c[0]+"  "+c[1],t.textareaText=i.reason,n.node_list.map(function(e,o){var a={user_name:e.user_name,user_id:e.user_id};0===o&&parseInt(e.user_id)===parseInt(t.curUserId)||t.approvalPersonArr.push(a)}),t.ccPersonArr=a.cc_people,console.log("dataObject.cc_people",a.cc_people),console.log("this.ccPersonArr",t.ccPersonArr),t.attachmentList=i.attachment_list,i.attachment_list.map(function(e){t.imgList.push(e.src)})}}).catch(function(t){console.log(t)})},getConf:function(){var t=this;console.log("获取--请假审批模板"),this.isEdit||a.a.call(this,"/mobicampus/leave/v1/getMatchedApproveConf?leave_type_id="+this.typeId+"&duration="+this.durationNum).then(function(e){t.canChangeProcess=e.canChangeProcess,t.approvalPersonArr=e.approvalPersonArr,t.canChangeCcpeople=e.canChangeCcpeople,t.ccPersonArr=e.ccPersonArr})},getLeaveType:function(){return this.$axios.get("/mobicampus/leave/v1/getTypeListBySchool").then(function(t){var e=t.data;if(200===e.status)return e.result.data})},postNewApplication:function(){var t=this;this.isCommited=!0;var e=this.typeId,o=this.typeName,a=this.dateSelA,i=this.dateSelB,n=this.textareaText,r=this.approvalPersonArr,s=this.durationNum,c=this.ccPersonArr,l=[];r.map(function(t){var e={user_id:t.user_id,user_name:t.user_name};l.push(e)});var m=a.split("  ")[0]+"  "+("上午"===a.split("  ")[1]?"07:50:00":"14:00:00"),d=i.split("  ")[0]+"  "+("上午"===i.split("  ")[1]?"12:00:00":"17:00:00"),p={leave:{type_id:parseInt(e),type_name:o,start_time:m,end_time:d,duration:parseInt(s),reason:n,attachment_list:this.attachmentList},node_list:l,cc_people:c};this.$axios.post("/mobicampus/leave/v1/newApplication",p).then(function(e){var o=e.data;console.log("data",o),200===o.status?t.$router.replace({name:"commitCom"}):t.isCommited=!1}).catch(function(t){console.log(t)})},commitBtnAction:function(){var t=this;if(!this.isCommited){var e=this.typeName,o=this.dateSelA,a=this.dateSelB,i=this.textareaText,n=this.approvalPersonArr;return e?o?a?i?n.length?void(0!==this.imgList.length?(this.isCommited=!0,Object(f.a)(this.imgList).then(function(e){0!==e.length?(t.attachmentList=e,t.postNewApplication()):(t.$simpleMsg("图片上传失败，请重新提交"),t.isCommited=!1)})):this.postNewApplication()):(this.$simpleMsg("请选择审批人"),!1):(this.$simpleMsg("请输入请假理由"),!1):(this.$simpleMsg("请选择结束时间"),!1):(this.$simpleMsg("请选择开始时间"),!1):(this.$simpleMsg("请选择请假类型"),!1)}}}},v=(o("9tff"),o("hghu")),b=Object(v.a)(h,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"qingjia page-bg"},[o("FormCom",[o("cell",{attrs:{button:"",title:"请假类型",content:t.typeName},on:{action:function(){return t.bottomOptionsShowA=1}}}),t._v(" "),o("cell",{attrs:{button:"",title:"开始时间",content:t.dateSelA},on:{action:function(){return t.SlideSelectDateShowA=!0}}}),t._v(" "),o("cell",{attrs:{button:"",title:"结束时间",content:t.dateSelB},on:{action:function(){return t.SlideSelectDateShowB=!0}}}),t._v(" "),o("cell",{attrs:{text:"",title:"请假时长",content:t.durationDay+"天 "}})],1),t._v(" "),o("TextareaCom",{attrs:{placeholder:"请输入请假理由",content:t.textareaText},on:{"update:content":function(e){t.textareaText=e}}}),t._v(" "),o("ApprovalProcess-com",{attrs:{needArrow:!0,needDelBtn:t.canChangeProcess,needAddBtn:t.canChangeProcess,approvalPersonArr:t.approvalPersonArr},on:{selectDirector:t.onSelectDirector,addPerson:t.showMemberSelect,memberAction:t.onMemberAction}}),t._v(" "),o("oa-ccPersonCom",{attrs:{ccPersonArr:t.ccPersonArr}}),t._v(" "),o("attachmentCom",{attrs:{imgList:t.imgList}}),t._v(" "),o("CommitBtnCom",{on:{action:t.commitBtnAction}}),t._v(" "),o("SlideSelectDate",{attrs:{show:t.SlideSelectDateShowA,value:t.dateSelA,maxValue:t.dateSelB},on:{"update:show":function(e){t.SlideSelectDateShowA=e},"update:value":function(e){t.dateSelA=e},error:function(e){t.timeError("开始时间不能晚于结束时间")}}}),t._v(" "),o("SlideSelectDate",{attrs:{show:t.SlideSelectDateShowB,value:t.dateSelB,minValue:t.dateSelA},on:{"update:show":function(e){t.SlideSelectDateShowB=e},"update:value":function(e){t.dateSelB=e},error:function(e){t.timeError("结束时间不能早于开始时间")}}}),t._v(" "),o("MemberSelect",{ref:"vMemberSelect"}),t._v(" "),o("BottomOptions",{attrs:{show:t.bottomOptionsShowA},on:{"update:show":function(e){t.bottomOptionsShowA=e}}},[o("ul",t._l(t.leaveTypeList,function(e,a){return o("li",{key:a,on:{click:function(o){t.LeaveTypeAction(e)}}},[t._v(t._s(e.name))])}))])],1)},[],!1,null,"30c5abe0",null);e.default=b.exports},"1/8j":function(t,e,o){var a=o("CnZS");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("51a9422f",a,!0,{})},"16Wm":function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,'.sendCom[data-v-98cec9c4]{padding:.46rem 0 .8rem}.sendCom .head-bg-box[data-v-98cec9c4]{position:fixed;width:100%;height:.29rem;top:0;left:0;background-color:#fff;z-index:1}.sendCom .item-box[data-v-98cec9c4]{width:100%;overflow:hidden;-webkit-transform:translate(0);-ms-transform:translate(0);transform:translate(0)}.sendCom .item-box .itemContent-box[data-v-98cec9c4]{-webkit-box-sizing:border-box;box-sizing:border-box;padding:.19rem .15rem .19rem .19rem}.sendCom .item-box .itemContent-box .title-box[data-v-98cec9c4]{display:-webkit-flex;display:-ms-flexbox;display:flex;margin-bottom:.03rem}.sendCom .item-box .itemContent-box .title-box .title[data-v-98cec9c4]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;font-size:.17rem;font-weight:700;color:#555;white-space:nowrap;-o-text-overflow:ellipsis;text-overflow:ellipsis;overflow:hidden}.sendCom .item-box .itemContent-box .title-box .status[data-v-98cec9c4]{font-size:.13rem;line-height:.2rem;padding:0 .09rem;color:#fff;border-radius:.04rem;margin-left:.1rem}.sendCom .item-box .itemContent-box .title-box .time[data-v-98cec9c4]{text-align:right;width:.8rem;line-height:.2rem;font-size:.12rem;color:#999}.sendCom .item-box .itemContent-box .itemType[data-v-98cec9c4]{line-height:.27rem;font-size:.13rem;color:#999;display:-webkit-flex;display:-ms-flexbox;display:flex}.sendCom .item-box .itemContent-box .itemType .contentText[data-v-98cec9c4]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;overflow:hidden;white-space:nowrap;-o-text-overflow:ellipsis;text-overflow:ellipsis}.sendCom .item-box .itemContent-box.active[data-v-98cec9c4]{-webkit-transform:translateX(.49rem);-ms-transform:translateX(.49rem);transform:translateX(.49rem)}.sendCom .item-box.searchActive[data-v-98cec9c4]{display:none}.icon-search[data-v-98cec9c4]:before{content:"\\E661";line-height:.4rem}',""])},"1Nvi":function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,".buttom-operation-box[data-v-70ada76a]{width:100%;height:.54rem;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:.54rem;text-align:center;font-size:.15rem;position:fixed;bottom:0;background:#fff;font-weight:700}.list[data-v-70ada76a]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;display:-webkit-flex;display:-ms-flexbox;display:flex}.item[data-v-70ada76a]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;border-right:1px solid #ddd;color:#88b8f8}.item[data-v-70ada76a]:last-child{border-right:0}.buttom-operation-box .keyboart-btn[data-v-70ada76a]{width:.69rem;color:#88b8f8;position:relative;font-weight:400;border-right:1px solid #ddd}.buttom-operation-box .keyboart-btn .iconfont-approval[data-v-70ada76a]{-webkit-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg);display:inline-block;-webkit-transition:all .5s;-o-transition:all .5s;transition:all .5s}.buttom-operation-box .keyboart-btn .iconfont-approval.active[data-v-70ada76a]{-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.buttom-operation-box .keyboart-btn>span[data-v-70ada76a]{font-size:.26rem}.buttom-operation-box .input-box[data-v-70ada76a]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;padding:.08rem .21rem .08rem .18rem}.buttom-operation-box .input-box .inputContent-box[data-v-70ada76a]{border-radius:.04rem;height:.36rem;border:1px solid #ddd;padding:0 .05rem;display:-webkit-flex;display:-ms-flexbox;display:flex}.buttom-operation-box .input-box .inputContent-box input[data-v-70ada76a]{outline:none;-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;border:none;padding-right:.03rem}.buttom-operation-box .input-box .inputContent-box .sendText[data-v-70ada76a]{width:.4rem;height:.28rem;line-height:.28rem;background-color:#ddd;color:#fff;font-weight:400;border-radius:.03rem;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;display:inline-block}.buttom-operation-box .input-box .inputContent-box .sendText.active[data-v-70ada76a]{background-color:#88b8f8}",""])},"1Svp":function(t,e,o){var a=o("QIlW");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("26f54ef6",a,!0,{})},"5q1O":function(t,e,o){"use strict";var a=o("ULP5"),i=o("NMVR"),n=new Date,r=n.getFullYear(),s=n.getMonth()+1,c=n.getDate(),l={name:"slide-select-date",props:["value","show","minValue","maxValue"],data:function(){return{startYear:r-10,titles:["年","月","日","时","分"],lists:[{d:[],i:0},{d:[],i:0},{d:[],i:0},{d:[],i:0},{d:[],i:0}]}},created:function(){if(this.value){var t=this.value.replace(/ +/," ").split(" ")[0].split("-");this.lists=i.a.getData(this.startYear,t[0],t[1]),this.lists[2].i=t[2]-1}else this.lists=i.a.getData(this.startYear,r,s),this.selectTody();this.lists.push({d:[],i:0}),this.lists.push({d:[],i:0});var e=i.a.getHours(),o=i.a.getMinutes(),a=new Date,n=void 0,c=void 0;if(this.value){var l=this.value.replace(/ +/," ").split(" ")[1].split(":");n=Number(l[0]),c=Number(l[1])}else n=a.getHours(),c=a.getMinutes();this.lists[3].d=e,this.lists[3].i=n,this.lists[4].d=o,this.lists[4].i=c},methods:{onChange:function(t,e){1===e&&this.dayUpdate()},dayUpdate:function(){var t=this.lists,e=t[0],o=t[1];this.$set(this.lists[2],"d",i.a.getDayData(e.d[e.i],o.d[o.i]))},selectTody:function(){var t=this.lists;t[0].i=r-this.startYear-1,t[1].i=s-1,t[2].i=c-1},onConfirm:function(t){var e=this.minValue,o=this.maxValue,a=this.lists,i=a[0],n=a[1],r=a[2],s=this.lists,c=s[3],l=s[4],m=c.d[c.i],d=l.d[l.i],p=i.d[i.i]+"-"+n.d[n.i]+"-"+r.d[r.i]+"  "+m+":"+d;e&&e>p||o&&o<p?this.$emit("error"):(this.$emit("update:value",p),t(1))}},components:{SlideSelect:a.a}},m=(o("H+WN"),o("hghu")),d=Object(m.a)(l,function(){var t=this,e=t.$createElement;return(t._self._c||e)("SlideSelect",{attrs:{show:t.show,titles:t.titles,lists:t.lists},on:{close:function(e){t.$emit("update:show",0)},change:t.onChange,confirm:t.onConfirm}})},[],!1,null,"6b0549a0",null);e.a=d.exports},"6Ist":function(t,e,o){var a=o("iTuz");(t.exports=o("lbwJ")(!1)).push([t.i,".personInfo[data-v-4eee0380]{width:100%;height:.51rem;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-bottom:.11rem}.personInfo .personInfo-left[data-v-4eee0380]{width:.51rem;height:.51rem;border-radius:50%;background-color:#ccc;background-image:url("+a(o("vi8c"))+");background-size:100%}.personInfo .personInfo-right[data-v-4eee0380]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;padding-left:.11rem;-webkit-box-sizing:border-box;box-sizing:border-box;line-height:.28rem}.personInfo .personInfo-right .personName[data-v-4eee0380]{font-size:.17rem;color:#555;font-weight:700}.personInfo .personInfo-right .status[data-v-4eee0380]{font-size:.14rem;line-height:.24rem}.detailContent-box[data-v-4eee0380]{background-color:#fff;padding:.1rem .16rem .32rem}.detailContent-box .info-row[data-v-4eee0380]{display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:.3rem;font-size:.13rem}.detailContent-box .info-row .keyText[data-v-4eee0380]{width:.75rem;color:#999}.detailContent-box .info-row .valueText[data-v-4eee0380]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;color:#666;word-break:break-all}.detailContent-box .info-row .valueText .personName[data-v-4eee0380]{margin-right:.05rem}.detailContent-box .info-row .switchBtn[data-v-4eee0380]{color:#70b9fe;margin-right:.05rem}.detailContent-box .attachment-box[data-v-4eee0380]{display:-webkit-flex;display:-ms-flexbox;display:flex}.detailContent-box .attachment-box span[data-v-4eee0380]{width:.7rem;color:#999}.detailContent-box .attachment-box .attachment[data-v-4eee0380]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;border-radius:.05rem;background-color:#f0f5f9}.detailContent-box .attachment-box .attachment .img-box[data-v-4eee0380]{height:.62rem;margin:.06rem .03rem 0;float:left}.detailContent-box .attachment-box .attachment .img-box img[data-v-4eee0380]{width:.5rem;height:.5rem;display:block}.detailContent-box .attachment-box .attachment .document-box[data-v-4eee0380]{height:.26rem;line-height:.26rem;float:left;margin:.03rem}.detailContent-box .attachment-box .attachment .document-box a[data-v-4eee0380]{color:#70b9fe;text-decoration:underline}.color-blue[data-v-4eee0380]{color:#6aa2d7}.color-red[data-v-4eee0380]{color:#ed5564}.color-green[data-v-4eee0380]{color:#18da55}.color-orange[data-v-4eee0380]{color:#f8ab59}.color-gray[data-v-4eee0380]{color:#999}.notice-row .valueText.active[data-v-4eee0380]{overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap}",""])},"6LAC":function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,'.buttom-operation-box[data-v-1ef6e811]{width:100%;height:.54rem;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:.54rem;text-align:center;font-size:.15rem;position:fixed;bottom:0;background:#fff;font-weight:700}.buttom-operation-box .keyboart-btn[data-v-1ef6e811]{width:.69rem;color:#88b8f8;position:relative;font-weight:400}.buttom-operation-box .keyboart-btn[data-v-1ef6e811]:after{content:"";display:block;width:1px;height:100%;border-right:1px solid #ddd;position:absolute;right:-1px;top:0;-webkit-transform:scaleX(.5);-ms-transform:scaleX(.5);transform:scaleX(.5)}.buttom-operation-box .keyboart-btn>span[data-v-1ef6e811]{font-size:.26rem}.buttom-operation-box .keyboart-btn .iconfont-approval[data-v-1ef6e811]{-webkit-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg);display:inline-block;-webkit-transition:all .5s;-o-transition:all .5s;transition:all .5s}.buttom-operation-box .keyboart-btn .iconfont-approval.active[data-v-1ef6e811]{-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.buttom-operation-box .revoke-btn[data-v-1ef6e811],.buttom-operation-box .urge-btn[data-v-1ef6e811]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;color:#88b8f8}.buttom-operation-box .input-box[data-v-1ef6e811]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;padding:.08rem .21rem .08rem .18rem}.buttom-operation-box .input-box .inputContent-box[data-v-1ef6e811]{border-radius:.04rem;height:.36rem;border:1px solid #ddd;padding:0 .05rem;display:-webkit-flex;display:-ms-flexbox;display:flex}.buttom-operation-box .input-box .inputContent-box input[data-v-1ef6e811]{outline:none;-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;border:none;padding-right:.03rem}.buttom-operation-box .input-box .inputContent-box .sendText[data-v-1ef6e811]{width:.4rem;height:.28rem;line-height:.28rem;background-color:#ddd;color:#fff;font-weight:400;border-radius:.03rem;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;display:inline-block}.buttom-operation-box .input-box .inputContent-box .sendText.active[data-v-1ef6e811]{background-color:#88b8f8}',""])},"6Yjp":function(t,e,o){var a=o("+UtQ");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("62095ee0",a,!0,{})},"74OJ":function(t,e,o){"use strict";var a=o("hlQj"),i=o("lXwO"),n={props:{colorTop:{type:String,default:"black"},colorBottom:{type:String,default:"black"}},components:{RefreshTop:i.a,LoaderBottom:a.a},mounted:function(){},methods:{initDragContainterMinHeight:function(){this.$nextTick(function(){})},reload:function(t){var e=this.$refs.vLoaderBottom;this.$emit("loadData",{type:"refresh",complete:t,vLoaderBottom:e})},loadData:function(t){var e=this.$refs.vLoaderBottom;this.$emit("loadData",{complete:t,vLoaderBottom:e})},refresh:function(){this.$refs.vRefreshTop.refresh()},reStart:function(){this.$refs.vLoaderBottom.reStart()}}},r=o("hghu"),s=Object(r.a)(n,function(){var t=this.$createElement,e=this._self._c||t;return e("RefreshTop",{ref:"vRefreshTop",attrs:{color:this.colorTop},on:{reload:this.reload}},[this._t("default"),this._v(" "),e("LoaderBottom",{ref:"vLoaderBottom",attrs:{color:this.colorBottom},on:{loadData:this.loadData}})],2)},[],!1,null,null,null);e.a=s.exports},"7QxT":function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,".yongche[data-v-33af4922]{padding-top:.12rem;padding-bottom:.36rem}",""])},"8A7h":function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,".yongche[data-v-46792b5b]{padding-top:.12rem;padding-bottom:.36rem}",""])},"8Who":function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,".caigou[data-v-524c2fdf]{overflow:hidden}.form-list[data-v-524c2fdf]:first-child,.FormCom[data-v-524c2fdf]{margin-top:.12rem}.form-title[data-v-524c2fdf]{background:#efefef;line-height:.32rem;text-align:center}.addAndDel-box[data-v-524c2fdf]{padding:0 .8rem;display:-webkit-flex;display:-ms-flexbox;display:flex;text-align:center;line-height:.3rem}.addAndDel-box .addBtn[data-v-524c2fdf]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;color:#6db1f1}.addAndDel-box .delBtn[data-v-524c2fdf]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;color:red}",""])},"9/Se":function(t,e,o){"use strict";var a=o("PZfr");o.n(a).a},"9tff":function(t,e,o){"use strict";var a=o("q2n7");o.n(a).a},Brzr:function(t,e,o){var a=o("iTuz");(t.exports=o("lbwJ")(!1)).push([t.i,"@font-face{font-family:iconfont-approval;src:url("+a(o("RQol"))+') format("truetype")}.approvalDetail[data-v-5d297acd] .iconfont-approval{font-family:iconfont-approval;font-size:.16rem;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.approvalDetail[data-v-5d297acd]{overflow-y:auto;-webkit-overflow-scrolling:touch}',""])},Bul9:function(t,e,o){var a=o("itbW");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("0e23a201",a,!0,{})},CnZS:function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,'.clearfix[data-v-e7665e14]:after{content:".";height:0;display:block;clear:both;overflow:hidden;visibility:hidden}.commitCom[data-v-e7665e14]{padding:.46rem 0 .8rem}.commitCom .head-bg-box[data-v-e7665e14]{position:fixed;width:100%;height:.29rem;top:0;left:0;background-color:#fff;z-index:1}.commitCom .item-box[data-v-e7665e14]{-webkit-transform:translate(0);-ms-transform:translate(0);transform:translate(0)}.commitCom .item-box[data-v-e7665e14]:last-child{margin-bottom:.1rem}.commitCom .item-box .itemContent-box[data-v-e7665e14]{-webkit-box-sizing:border-box;box-sizing:border-box;padding:.19rem .15rem .19rem .19rem;-webkit-transition:all .5s;-o-transition:all .5s;transition:all .5s}.commitCom .item-box .itemContent-box .title-box[data-v-e7665e14]{display:-webkit-flex;display:-ms-flexbox;display:flex;margin-bottom:.03rem}.commitCom .item-box .itemContent-box .title-box .title[data-v-e7665e14]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;font-size:.17rem;font-weight:700;color:#555;white-space:nowrap;-o-text-overflow:ellipsis;text-overflow:ellipsis;overflow:hidden}.commitCom .item-box .itemContent-box .title-box .status[data-v-e7665e14]{font-size:.13rem;line-height:.2rem;padding:0 .09rem;color:#fff;border-radius:.04rem;margin-left:.1rem}.commitCom .item-box .itemContent-box .title-box .status.bg-blue[data-v-e7665e14]{background-color:#6aa2d7}.commitCom .item-box .itemContent-box .title-box .status.bg-red[data-v-e7665e14]{background-color:#ed5564}.commitCom .item-box .itemContent-box .title-box .status.bg-green[data-v-e7665e14]{background-color:#1ab394}.commitCom .item-box .itemContent-box .title-box .status.bg-gray[data-v-e7665e14]{color:#999;border:.01rem solid #999;-webkit-box-sizing:border-box;box-sizing:border-box}.commitCom .item-box .itemContent-box .title-box .time[data-v-e7665e14]{text-align:right;width:1.2rem;line-height:.2rem;font-size:.12rem;color:#999}.commitCom .item-box .itemContent-box .itemType[data-v-e7665e14]{line-height:.27rem;font-size:.13rem;color:#999;display:-webkit-flex;display:-ms-flexbox;display:flex}.commitCom .item-box .itemContent-box .itemType .contentText[data-v-e7665e14]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;overflow:hidden;white-space:nowrap;-o-text-overflow:ellipsis;text-overflow:ellipsis}.commitCom .item-box .itemContent-box.active[data-v-e7665e14]{-webkit-transform:translateX(.49rem);-ms-transform:translateX(.49rem);transform:translateX(.49rem)}.commitCom .item-box.searchActive[data-v-e7665e14]{display:none}.icon-search[data-v-e7665e14]:before{content:"\\E661";line-height:.4rem}',""])},D40k:function(t,e,o){var a=o("jAdf");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("3f12f834",a,!0,{})},D9fI:function(t,e,o){"use strict";o.r(e);var a=o("lKpO"),i=o("hHQW"),n=o("8ffV"),r=o("8CNX"),s=o("KqdF"),c=o("OZ6h"),l=o("TR4X"),m=o("cTMg"),d=o("kV9B"),p=o("6UnF"),u=o("p/l8"),f={components:{Cell:i.a,FormCom:n.a,CommitBtnCom:r.a,TextareaCom:s.a,ConfirmBoxCom:c.a,SlideSelectDate:l.a,ApprovalProcessCom:m.a,MemberSelect:u.a,ccPersonCom:d.a,AttachmentCom:p.a},data:function(){return{canChangeProcess:!0,canChangeCcpeople:!0,currDelFormIndex:0,imgList:[],fileList:[],attachmentList:[],ccPersonArr:[],isShowConfirmBoxCom:!1,selectedData:{memberList:[],deptList:[],memberListSubmit:[]},detailArr:[{name:"",size:"",num:"",price:""}],SlideSelectDateShow:!1,dateStr:"",textareaText:"",approvalPersonArr:[]}},watch:{amount:function(){this.getConf()}},computed:{amount:function(){var t=0;return this.detailArr.forEach(function(e){var o=e.num,a=e.price;t+=o*a}),t}},created:function(){this.$route.query.detailData&&this.initData()},methods:{initData:function(){var t=this.$route.query.detailData,e=t.resource,o=t.process,a=t.cc_people;this.textareaText=e.desc,this.amount=e.amount,this.approvalPersonArr=o.node_list.map(function(t){return{user_name:t.user_name,user_id:t.user_id}}),this.ccPersonArr=a.map(function(t){return{user_name:t.user_name,user_id:t.user_id}}),this.detailArr=e.item_list.map(function(t){return{name:t.name,size:t.spec,num:t.total,price:t.unit_price}})},getConf:function(){var t=this;console.log("获取--请假审批模板"),a.a.call(this,"/mobicampus/assets/v1/purchase/approveconf/match?amount="+this.amount).then(function(e){t.canChangeProcess=e.canChangeProcess,t.approvalPersonArr=e.approvalPersonArr,t.canChangeCcpeople=e.canChangeCcpeople,t.ccPersonArr=e.ccPersonArr})},onDelConfirm:function(){this.isShowConfirmBoxCom=!1,this.detailArr.splice(this.currDelFormIndex,1)},addFormAction:function(){this.detailArr.push({name:"",size:"",num:"",price:""})},delFormAction:function(t){this.isShowConfirmBoxCom=!0,this.currDelFormIndex=t},onMemberAction:function(t){this.$refs.vMemberSelect.show({onConfirm:function(e){0!==e.memberList.length&&(t.user_name=e.memberList[0].user_name,t.user_id=e.memberList[0].user_id)}})},onMemberSelectB:function(t){var e=this;console.log("this.ccPersonArr",this.ccPersonArr),this.$refs.vMemberSelect.show({type:"multiple",selectedData:this.selectedData,onConfirm:function(t){e.selectedData=t,e.ccPersonArr=t.memberListSubmit}})},commitBtnAction:function(){var t=this;if(this.isCommited)return 0;this.isCommited=!0;var e=this.textareaText,o=this.amount,a=this.approvalPersonArr,i=this.detailArr;return e?o?!!i.every(function(e,o){var a=e.name,i=e.size,n=e.num,r=e.price;return a?i?r?!!n||(t.$simpleMsg("请输入采购明细"+(o+1)+"的数量"),t.isCommited=!1,!1):(t.$simpleMsg("请输入采购明细"+(o+1)+"的单价"),t.isCommited=!1,!1):(t.$simpleMsg("请输入采购明细"+(o+1)+"的规格"),t.isCommited=!1,!1):(t.$simpleMsg("请输入采购明细"+(o+1)+"的名称"),t.isCommited=!1,!1)})&&(a.length?void this.postData():(this.$simpleMsg("请选择审批人"),this.isCommited=!1,!1)):(this.$simpleMsg("请输入总金额"),this.isCommited=!1,!1):(this.$simpleMsg("请输入采购事由"),this.isCommited=!1,!1)},postData:function(){var t=this,e=this.textareaText,o=this.amount,a=this.detailArr,i=this.approvalPersonArr,n=this.ccPersonArr,r={purchase:{desc:e,amount:o,item_list:a=a.map(function(t){return{name:t.name,spec:t.size,unit_price:t.price,total:t.num}})},node_list:i,cc_people:n};return this.$preloaderFull.show(),this.$axios.post("/mobicampus/assets/v1/purchase/application/create",r).then(function(e){var o=e.data;t.$preloaderFull.close(),200===o.status&&t.$router.replace({name:"commitCom"})})}}},h=(o("HK8z"),o("hghu")),v=Object(h.a)(f,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"caigou  page-bg"},[o("TextareaCom",{attrs:{placeholder:"请输入采购事由",content:t.textareaText},on:{"update:content":function(e){t.textareaText=e}}}),t._v(" "),o("FormCom",{staticClass:"FormCom"},[o("cell",{attrs:{text:"",title:"总金额",content:t.amount+"元",placeholder:"请输入总金额(元)"}})],1),t._v(" "),t._l(t.detailArr,function(e,a){return o("div",{key:a,staticClass:"form-list time-box"},[o("div",{staticClass:"form-title"},[t._v(t._s("明细表单"+(a+1)))]),t._v(" "),o("FormCom",[o("cell",{attrs:{input:"",title:"品名",content:e.name,placeholder:"请输入品名"},on:{"update:content":function(o){t.$set(e,"name",o)}}}),t._v(" "),o("cell",{attrs:{input:"",title:"规格",content:e.size,placeholder:"请输入规格"},on:{"update:content":function(o){t.$set(e,"size",o)}}}),t._v(" "),o("cell",{attrs:{input:"",type:"number",title:"单价",content:e.price,placeholder:"请输入单价"},on:{"update:content":function(o){t.$set(e,"price",o)}}}),t._v(" "),o("cell",{attrs:{input:"",type:"number",title:"数量",content:e.num,placeholder:"请输入数量"},on:{"update:content":function(o){t.$set(e,"num",o)}}})],1),t._v(" "),o("div",{staticClass:"form-bottom addAndDel-box"},[o("div",{directives:[{name:"show",rawName:"v-show",value:a===t.detailArr.length-1,expression:"i === detailArr.length - 1"}],staticClass:"addBtn"},[o("span",{staticClass:"iconfont-approval"},[t._v("")]),t._v(" "),o("span",{staticClass:"text",on:{click:t.addFormAction}},[t._v("添加")])]),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:1!==t.detailArr.length,expression:"detailArr.length !== 1"}],staticClass:"delBtn",on:{click:function(e){t.delFormAction(a)}}},[o("span",{staticClass:"iconfont-approval"},[t._v("")]),t._v(" "),o("span",{staticClass:"text"},[t._v("删除")])])])],1)}),t._v(" "),o("oa-approvalProcess",{attrs:{needArrow:!0,needDelBtn:t.canChangeProcess,needAddBtn:t.canChangeProcess,approvalPersonArr:t.approvalPersonArr}}),t._v(" "),o("ccPersonCom",{attrs:{ccPersonArr:t.ccPersonArr},on:{addPerson:t.onMemberSelectB}}),t._v(" "),o("attachmentCom",{attrs:{imgList:t.imgList}}),t._v(" "),o("CommitBtnCom",{on:{action:t.commitBtnAction}}),t._v(" "),o("SlideSelectDate",{attrs:{show:t.SlideSelectDateShow,value:t.dateStr},on:{"update:show":function(e){t.SlideSelectDateShow=e},"update:value":function(e){t.dateStr=e},error:function(e){t.timeError("开始时间不能晚于结束时间")}}}),t._v(" "),o("MemberSelect",{ref:"vMemberSelect"}),t._v(" "),o("ConfirmBoxCom",{directives:[{name:"show",rawName:"v-show",value:t.isShowConfirmBoxCom,expression:"isShowConfirmBoxCom"}],attrs:{title:"提示",content:"确定删除？"},on:{confirmAction:t.onDelConfirm,cancelAction:function(e){t.isShowConfirmBoxCom=!1}}})],2)},[],!1,null,"524c2fdf",null);e.default=v.exports},DHf9:function(t,e,o){"use strict";var a=o("M90/");o.n(a).a},G8eR:function(t,e,o){"use strict";o.r(e);var a={data:function(){return{itemArr:[[{content:"请假",icon:"&#xe61d;",iconClass:"icon-qingjia iconfont-approval",bg:"#fbc639",routeName:"qingjia",status:1},{content:"外出",icon:"&#xe6f3;",iconClass:"icon-waichu iconfont-approval",bg:"#00bb54",routeName:"waichu",status:1},{content:"换课",icon:"&#xe767;",iconClass:"icon-tiaoke iconfont-approval",bg:"#01c095",routeName:"tiaoke",status:1}],[{content:"顶课",icon:"&#xe600;",iconClass:"icon-dingke iconfont-approval",bg:"#ef7d0a",routeName:"dingke",status:1},{content:"经费",icon:"&#xe61b;",iconClass:"icon-jingfei iconfont-approval",bg:"#4da5e5",routeName:"jingfei",status:1},{content:"用车",icon:"&#xe629;",iconClass:"icon-yongche iconfont-approval",bg:"#20d2aa",routeName:"yongche",status:1}],[{content:"采购",icon:"&#xe60a;",iconClass:"icon-caigou iconfont-approval",bg:"#7a9cf7",routeName:"caigou",status:1},{content:"报修",icon:"&#xe660;",iconClass:"icon-baoxiu iconfont-approval",bg:"#be7ccc",routeName:"baoxiu",status:0},{content:"",icon:"",iconClass:"",routeName:"",status:0}]]}},methods:{itemArrAction:function(t,e){0!==t.status&&this.$router.push({name:t.routeName,params:{id:e}})}}},i=(o("Vs3L"),o("hghu")),n={name:"approval-index",props:["bus"],data:function(){return{isCom:"applyCom",tabList:[{content:"新申请",iconClass:"icon-apply",com:"approvalIndex"},{content:"我审批的",iconClass:"icon-approval",com:"approvalCom"},{content:"我提交的",iconClass:"icon-submit",com:"commitCom"},{content:"抄送我的",iconClass:"icon-send",com:"sendCom"}]}},methods:{tabAction:function(t){this.$router.push({name:t})}},components:{applyCom:Object(i.a)(a,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"content-box"},[o("div",{staticClass:"row_01 row"},t._l(t.itemArr[0],function(e,a){return o("oa-iconBtn",{key:a,class:{v:0===e.status},attrs:{item:e,attr:"content",itemWidth:"55"},on:{action:function(e){return t.itemArrAction(e,"0")}}})})),t._v(" "),o("div",{staticClass:"row_02 row"},t._l(t.itemArr[1],function(e,a){return o("oa-iconBtn",{key:a,class:{v:0===e.status},attrs:{item:e,attr:"content",itemWidth:"55"},on:{action:function(e){return t.itemArrAction(e,"0")}}})})),t._v(" "),o("div",{staticClass:"row_03 row"},t._l(t.itemArr[2],function(e,a){return o("oa-iconBtn",{key:a,class:{v:0===e.status},attrs:{item:e,attr:"content",itemWidth:"55"},on:{action:function(e){return t.itemArrAction(e,"0")}}})}))])},[],!1,null,"6c5b2e4c",null).exports}},r=(o("Ln+O"),Object(i.a)(n,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"approval"},[e("keep-alive"),this._v(" "),e(this.isCom,{tag:"component"}),this._v(" "),e("keep-alive")],1)},[],!1,null,"1b0b5932",null));e.default=r.exports},"H+WN":function(t,e,o){"use strict";var a=o("Bul9");o.n(a).a},HE9K:function(t,e,o){var a=o("6LAC");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("9e41148c",a,!0,{})},HK8z:function(t,e,o){"use strict";var a=o("gKfL");o.n(a).a},IFRh:function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,".mask-box[data-v-1f100911]{position:fixed;left:0;top:0;right:0;bottom:0;background-color:#333;opacity:.3;z-index:10}.warn-box[data-v-1f100911]{position:fixed;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:2rem;border-radius:.05rem;text-align:center;background-color:#fff;z-index:11}.warn-box .title[data-v-1f100911]{line-height:.36rem;font-size:.2rem;font-weight:700}.warn-box .content[data-v-1f100911]{line-height:.24rem;font-size:.16rem;padding:.2rem .15rem}.warn-box .btn-box[data-v-1f100911]{display:-webkit-flex;display:-ms-flexbox;display:flex}.warn-box .btn-box .btn[data-v-1f100911]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;line-height:.34rem;border-left:1px solid #efefef;color:#88b8f8;font-weight:700}.warn-box .btn-box .confirm[data-v-1f100911]{border-left:0}",""])},J8TP:function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,".v-enter[data-v-7e963d4a],.v-leave-to[data-v-7e963d4a]{-webkit-transform:scale(.8);-ms-transform:scale(.8);transform:scale(.8);opacity:0}.v-enter-active[data-v-7e963d4a],.v-leave-active[data-v-7e963d4a]{-webkit-transition:all .2s;-o-transition:all .2s;transition:all .2s}.box[data-v-7e963d4a]{border-radius:.1rem;background:#ccc;position:fixed;width:3rem;height:2rem;left:50%;top:50%;margin-left:-1.5rem;margin-top:-1rem;border:.01rem solid #ccc}li.active[data-v-7e963d4a]{background:#ccc}",""])},JCDb:function(t,e,o){"use strict";var a=o("kKDE");o.n(a).a},JocO:function(t,e,o){"use strict";var a=o("HE9K");o.n(a).a},"Jua+":function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,".approval .content-box .row[data-v-6c5b2e4c]{display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-justify-content:space-around;-ms-flex-pack:distribute;justify-content:space-around}.approval .content-box .row.row_01[data-v-6c5b2e4c]{margin-top:.62rem}.approval .content-box .row.row_02[data-v-6c5b2e4c],.approval .content-box .row.row_03[data-v-6c5b2e4c]{margin-top:.78rem}.v[data-v-6c5b2e4c]{visibility:hidden}",""])},K1Ne:function(t,e,o){"use strict";var a=o("PruU");o.n(a).a},KqdF:function(t,e,o){"use strict";var a={components:{FormCom:o("8ffV").a},props:{placeholder:{type:String,default:"请输入..."},content:{type:String,default:""},readonly:{type:Boolean,default:!1}},watch:{content:{handler:function(t){this.textareaText=t},immediate:!0}},data:function(){return{textareaText:""}}},i=(o("X4hB"),o("hghu")),n=Object(i.a)(a,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("FormCom",{staticClass:"form-com"},[o("div",{staticClass:"reasonContent-box"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.textareaText,expression:"textareaText"}],staticClass:"textarea",attrs:{readonly:t.readonly,placeholder:t.placeholder},domProps:{value:t.textareaText},on:{change:function(e){t.$emit("update:content",t.textareaText)},input:function(e){e.target.composing||(t.textareaText=e.target.value)}}})])])},[],!1,null,"06b211f7",null);e.a=n.exports},"Ln+O":function(t,e,o){"use strict";var a=o("D40k");o.n(a).a},Lxdk:function(t,e,o){var a=o("aYng");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("6adec56c",a,!0,{})},"M90/":function(t,e,o){var a=o("R8lF");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("4439c70d",a,!0,{})},MQfr:function(t,e,o){"use strict";var a=o("ZLHK");o.n(a).a},MWlb:function(t,e,o){"use strict";var a=o("dbf6");o.n(a).a},NiyM:function(t,e,o){"use strict";var a=o("1/8j");o.n(a).a},OXc3:function(t,e,o){"use strict";o.r(e);var a=o("hHQW"),i=o("8ffV"),n=o("8CNX"),r=o("KqdF"),s=o("lKpO"),c=o("p/l8"),l=o("ydf2"),m=o("cTMg"),d=o("kV9B"),p=o("6UnF"),u=o("xVKS"),f=o("k0ul"),h={components:{CommitBtnCom:n.a,MemberSelect:c.a,SlideSelectDate:l.a,ApprovalProcessCom:m.a,ccPersonCom:d.a,AttachmentCom:p.a,BottomOptions:u.a,TextareaCom:r.a,Cell:a.a,FormCom:i.a},data:function(){return{amount:"",typeId:"",typeName:"",isCommited:!1,selectedData:{memberList:[],deptList:[],memberListSubmit:[]},canChangeProcess:!0,canChangeCcpeople:!0,jfTypeList:[],imgList:[],fileList:[],attachmentList:[],approvalPersonArr:[],ccPersonArr:[],textareaText:"",bottomOptionsShow:!1}},watch:{typeId:function(){this.getConf()}},created:function(){var t=this;this.getAllFundTypeListByCampus().then(function(e){t.jfTypeList=e}),this.$route.params.id&&"0"!==this.$route.params.id&&this.getApplicationDetails()},methods:{getConf:function(){var t=this;s.a.call(this,"/mobicampus/fund/v1/getMatchedApproveConf/3").then(function(e){t.canChangeProcess=e.canChangeProcess,t.approvalPersonArr=e.approvalPersonArr,t.ccPersonArr=e.ccPersonArr,t.selectedData.memberList=t.ccPersonArr})},bottomOptionsAction:function(t){this.typeId=t.id,this.typeName=t.name,this.bottomOptionsShow=!1},onSelectDirector:function(t){this.$refs.vMemberSelect.show({staticData:t.leader_list,onConfirm:function(e){0!==e.memberList.length&&(t.user_name=e.memberList[0].user_name,t.user_id=e.memberList[0].user_id)}})},onMemberAction:function(t){this.$refs.vMemberSelect.show({onConfirm:function(e){0!==e.memberList.length&&(t.user_name=e.memberList[0].user_name,t.user_id=e.memberList[0].user_id)}})},onMemberSelect:function(){var t=this;this.$refs.vMemberSelect.show({type:"single",onConfirm:function(e){if(console.log("selectedData",e),0!==e.memberList.length){var o=t.approvalPersonArr.length;if(o&&t.approvalPersonArr[o-1].user_id===e.memberList[0].user_id)return t.$simpleMsg("该成员与上级重复"),t.member=!0,!1;t.approvalPersonArr.push(e.memberList[0])}}})},onMemberSelectB:function(t){var e=this;console.log("this.ccPersonArr",this.ccPersonArr),this.$refs.vMemberSelect.show({type:"multiple",selectedData:this.selectedData,onConfirm:function(t){e.selectedData=t,e.ccPersonArr=t.memberListSubmit}})},commitBtnAction:function(){var t=this;if(this.isCommited)return 0;var e=this.amount,o=this.typeName,a=this.textareaText,i=this.approvalPersonArr;return e?o?a?i.length?(this.isCommited=!0,void(0!==this.imgList.length?Object(f.a)(this.imgList).then(function(e){0!==e.length?(t.attachmentList=e,t.postData()):(t.$simpleMsg("图片上传失败，请重新提交"),t.isCommited=!1)}):this.postData())):(this.$simpleMsg("请选择审批人"),!1):(this.$simpleMsg("请输入经费用途"),!1):(this.$simpleMsg("请选择经费类型"),!1):(this.$simpleMsg("请输入经费金额"),!1)},postData:function(){var t=this,e={fund:{type_id:this.typeId,type_name:this.typeName,amount:this.amount,desc:this.textareaText,attachment_list:this.attachmentList},node_list:this.approvalPersonArr,cc_people:this.ccPersonArr};this.$preloaderFull.show(),this.$axios.post("/mobicampus/fund/v1/createApplication",e).then(function(e){var o=e.data;t.isCommited=!1,t.$preloaderFull.close(),console.log("data",o),200===o.status?t.$router.replace({name:"commitCom"}):t.isCommited=!1}).catch(function(t){console.log(t)})},getAllFundTypeListByCampus:function(){return this.$axios.get("/mobicampus/fund/v1/getTypeListBySchool").then(function(t){var e=t.data;if(200===e.status)return e.result.data})},getApplicationDetails:function(){var t=this;this.$axios.get("/mobicampus/approve/v1/getApplicationDetails/"+this.$route.params.id).then(function(e){var o=e.data;if(200===o.status){console.log("重新提交",o);var a=o.result.data,i=a.resource,n=a.process,r=a.cc_people;console.log("resource",i),t.amount=i.amount,t.typeName=i.type_name,t.typeId=i.type_id,t.textareaText=i.desc,"4"===n.node_list[0].state_processed&&n.node_list.shift(),t.approvalPersonArr=n.node_list.map(function(t){return{user_name:t.user_name,user_id:t.user_id}}),t.ccPersonArr=r.map(function(t){return{user_name:t.user_name,user_id:t.user_id}}),t.attachmentList=i.attachment_list,t.imgList=i.attachment_list.map(function(t){return t.src})}})}}},v=(o("Ylvx"),o("hghu")),b=Object(v.a)(h,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"yongche  page-bg"},[o("FormCom",[o("cell",{attrs:{input:"",type:"number",title:"经费金额",content:t.amount,placeholder:"填写金额(元)"},on:{"update:content":function(e){t.amount=e}}}),t._v(" "),o("cell",{attrs:{button:"",title:"经费类型",content:t.typeName},on:{action:function(e){t.bottomOptionsShow=1}}})],1),t._v(" "),o("TextareaCom",{attrs:{placeholder:"请输入经费用途",content:t.textareaText},on:{"update:content":function(e){t.textareaText=e}}}),t._v(" "),o("ApprovalProcess-com",{attrs:{needDelBtn:t.canChangeProcess,needAddBtn:t.canChangeProcess,needArrow:!0,approvalPersonArr:t.approvalPersonArr},on:{addPerson:t.onMemberSelect,memberAction:t.onMemberAction,selectDirector:t.onSelectDirector}}),t._v(" "),o("ccPersonCom",{attrs:{ccPersonArr:t.ccPersonArr},on:{addPerson:t.onMemberSelectB}}),t._v(" "),o("attachmentCom",{attrs:{imgList:t.imgList}}),t._v(" "),o("CommitBtnCom",{on:{action:t.commitBtnAction}}),t._v(" "),o("MemberSelect",{ref:"vMemberSelect"}),t._v(" "),o("BottomOptions",{attrs:{show:t.bottomOptionsShow},on:{"update:show":function(e){t.bottomOptionsShow=e}}},[o("ul",t._l(t.jfTypeList,function(e,a){return o("li",{key:a,on:{click:function(o){t.bottomOptionsAction(e)}}},[t._v(t._s(e.name))])}))])],1)},[],!1,null,"33af4922",null);e.default=b.exports},OZe1:function(t,e,o){"use strict";var a=o("QKlq");o.n(a).a},OzoW:function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,'.clearfix[data-v-127ec07c]:after{content:".";height:0;display:block;clear:both;overflow:hidden;visibility:hidden}.approvalCom[data-v-127ec07c]{padding:.86rem 0 .8rem}.approvalCom.isHide[data-v-127ec07c]{height:0;overflow:hidden}.approvalCom .head[data-v-127ec07c]{padding-top:.12rem;margin-bottom:.26rem;position:fixed;top:0;width:100%;z-index:1}.approvalCom .head .tabs-box[data-v-127ec07c]{display:-webkit-flex;display:-ms-flexbox;display:flex}.approvalCom .head .tabs-box .tab[data-v-127ec07c]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;text-align:center;font-size:.15rem;line-height:.19rem;color:#7abfff;position:relative}.approvalCom .head .tabs-box .tab .underline-box[data-v-127ec07c]{width:.3rem;height:.02rem;background-color:#fff;position:absolute;bottom:-.05rem;left:50%;margin-left:-.15rem}.approvalCom .head .tabs-box .tab.active[data-v-127ec07c]{color:#fff}.approvalCom .item-box[data-v-127ec07c]{padding:1px 0;width:100%;position:relative;overflow:hidden;-webkit-transform:translate(0);-ms-transform:translate(0);transform:translate(0)}.approvalCom .item-box .singleSel-box[data-v-127ec07c]{width:.22rem;height:.22rem;border-radius:50%;border:1px solid #c4c5c7;position:absolute;left:.16rem;top:50%;margin-top:-.11rem}.approvalCom .item-box .singleSel-box.active[data-v-127ec07c]{border:none}.approvalCom .item-box .itemContent-box[data-v-127ec07c]{position:relative;background-color:#fff;border-radius:.09rem;-webkit-box-sizing:border-box;box-sizing:border-box;padding:.19rem .15rem .19rem .19rem;-webkit-transition:all .5s;-o-transition:all .5s;transition:all .5s}.approvalCom .item-box .itemContent-box .title-box[data-v-127ec07c]{display:-webkit-flex;display:-ms-flexbox;display:flex;margin-bottom:.03rem}.approvalCom .item-box .itemContent-box .title-box .title[data-v-127ec07c]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;font-size:.17rem;font-weight:700;color:#555;white-space:nowrap;-o-text-overflow:ellipsis;text-overflow:ellipsis;overflow:hidden}.approvalCom .item-box .itemContent-box .title-box .status[data-v-127ec07c]{font-size:.13rem;line-height:.2rem;padding:0 .09rem;color:#fff;border-radius:.04rem;margin-left:.1rem}.approvalCom .item-box .itemContent-box .title-box .status.filtelActive[data-v-127ec07c]{display:none}.approvalCom .item-box .itemContent-box .title-box .status.bg-blue[data-v-127ec07c]{background-color:#6aa2d7}.approvalCom .item-box .itemContent-box .title-box .status.bg-red[data-v-127ec07c]{background-color:#ed5564}.approvalCom .item-box .itemContent-box .title-box .status.bg-green[data-v-127ec07c]{background-color:#1ab394}.approvalCom .item-box .itemContent-box .title-box .status.bg-gray[data-v-127ec07c]{color:#999;border:1px solid #999;-webkit-box-sizing:border-box;box-sizing:border-box}.approvalCom .item-box .itemContent-box .title-box .time[data-v-127ec07c]{text-align:right;width:.8rem;line-height:.2rem;font-size:.12rem;color:#999}.approvalCom .item-box .itemContent-box .itemType[data-v-127ec07c]{line-height:.27rem;font-size:.13rem;color:#999;display:-webkit-flex;display:-ms-flexbox;display:flex}.approvalCom .item-box .itemContent-box .itemType .contentText[data-v-127ec07c]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;overflow:hidden;white-space:nowrap;-o-text-overflow:ellipsis;text-overflow:ellipsis}.approvalCom .item-box .itemContent-box.active[data-v-127ec07c]{-webkit-transform:translateX(.49rem);-ms-transform:translateX(.49rem);transform:translateX(.49rem)}.approvalCom .item-box.searchActive[data-v-127ec07c]{display:none}.approvalCom .bottom-allSel-box[data-v-127ec07c]{position:fixed;width:100%;height:.54rem;display:-webkit-flex;display:-ms-flexbox;display:flex;bottom:-.54rem;left:0;z-index:10;-webkit-transition:all .5s;-o-transition:all .5s;transition:all .5s}.approvalCom .bottom-allSel-box .btn-cancel[data-v-127ec07c]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;background-color:#fff;color:#999;display:-webkit-flex;display:-ms-flexbox;display:flex}.approvalCom .bottom-allSel-box .btn-cancel .cancel-left[data-v-127ec07c]{width:.55rem}.approvalCom .bottom-allSel-box .btn-cancel .cancel-right[data-v-127ec07c]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;text-align:center;line-height:.54rem}.approvalCom .bottom-allSel-box .btn-cancel .singleSel-box[data-v-127ec07c]{width:.22rem;height:.22rem;border-radius:50%;position:absolute;left:.16rem;top:50%;margin-top:-.11rem;border:1px solid #c4c5c7}.approvalCom .bottom-allSel-box .btn-cancel .singleSel-box.active[data-v-127ec07c]{border:none}.approvalCom .bottom-allSel-box .btn-sure[data-v-127ec07c]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;background-color:#7fc1fe;text-align:center;line-height:.54rem;color:#fff}.approvalCom .bottom-allSel-box.active[data-v-127ec07c]{bottom:0}.singleSel-box .iconfont-approval[data-v-127ec07c]{font-size:.25rem;line-height:.25rem;display:inline-block;position:relative;left:-1px;top:-1px;color:#88b8f8}.all-select[data-v-127ec07c]{width:.79rem;border-left:1px solid #ddd;color:#999;border-top-right-radius:.09rem;border-bottom-right-radius:.09rem}.all-select .icon-box.allSel[data-v-127ec07c]{display:inline-block;margin-left:.12rem;float:left;line-height:.3rem}.all-select .icon-box.allSel .icon-allSel[data-v-127ec07c]:before{font-size:.2rem;content:"\\E6CA"}.all-select .words-box[data-v-127ec07c]{width:.28rem;line-height:.12rem;font-size:.12rem;margin-left:.08rem;display:inline-block;float:left}.all-select .words-box span[data-v-127ec07c]{-webkit-align-items:center;-ms-flex-align:center;align-items:center;height:.24rem;display:inline-block;margin-top:.03rem;font-weight:700}.all-select.active[data-v-127ec07c]{background-color:#88b8f8;color:#fff}',""])},PZfr:function(t,e,o){var a=o("Y/JG");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("048c2443",a,!0,{})},PruU:function(t,e,o){var a=o("s5PD");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("50abc5d6",a,!0,{})},QIlW:function(t,e,o){var a=o("iTuz");(t.exports=o("lbwJ")(!1)).push([t.i,".processContent-box[data-v-17a272e0]{background-color:#fff;padding:0 .16rem .54rem;margin-top:.14rem}.processContent-box .processContent-head[data-v-17a272e0]{font-size:.17rem;font-weight:700;color:#333;height:.73rem;line-height:.73rem}.processContent-box .processList .processItem[data-v-17a272e0]{display:-webkit-flex;display:-ms-flexbox;display:flex;padding-bottom:.31rem}.processContent-box .processList .processItem .processItem-left[data-v-17a272e0]{width:.3rem;height:.3rem;border-radius:50%;background-color:#ccc;background-image:url("+a(o("vi8c"))+");background-size:100%}.processContent-box .processList .processItem .processItem-right[data-v-17a272e0]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;padding-left:.1rem}.processContent-box .processList .processItem .processItem-right .viewText[data-v-17a272e0]{float:left;margin-left:.1rem;line-height:.27rem;font-size:.15rem}.processContent-box .processList .processItem .processItem-right .personName-box .personName[data-v-17a272e0]{float:left;line-height:.29rem;font-size:.15rem}.processContent-box .processList .processItem .processItem-right .personName-box .time[data-v-17a272e0]{float:right;color:#999;font-size:.12rem;line-height:.29rem}.processContent-box .processList .processItem .processItem-right .opinionList .personName[data-v-17a272e0]{color:#2568a7;font-size:.12rem}.processContent-box .processList .processItem .processItem-right .opinionList .contentText[data-v-17a272e0]{font-size:.12rem}.color-blue[data-v-17a272e0]{color:#6aa2d7}.color-red[data-v-17a272e0]{color:#ed5564}.color-green[data-v-17a272e0]{color:#18da55}.color-orange[data-v-17a272e0]{color:#f8ab59}.color-gray[data-v-17a272e0]{color:#999}",""])},QKlq:function(t,e,o){var a=o("16Wm");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("a6745adc",a,!0,{})},QNfw:function(t,e,o){var a=o("6Ist");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("aba2da00",a,!0,{})},R8lF:function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,".dingke[data-v-6b54f369]{padding-top:.12rem;padding-bottom:.52rem}.form-box[data-v-6b54f369]{-webkit-transform:translate(0);-ms-transform:translate(0);transform:translate(0)}.form-box .addAndDel-box[data-v-6b54f369]{padding:0 .8rem;display:-webkit-flex;display:-ms-flexbox;display:flex;text-align:center;line-height:.3rem}.form-box .addAndDel-box .addBtn[data-v-6b54f369]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;color:#6db1f1}.form-box .addAndDel-box .delBtn[data-v-6b54f369]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;color:red}.formContent-box[data-v-6b54f369]{margin:0 .1rem;border-radius:.08rem;background-color:#fff}.formContent-box .row[data-v-6b54f369]{height:.54rem;line-height:.52rem;padding:0 .1rem 0 .19rem}.formContent-box .row .row-left[data-v-6b54f369]{float:left;color:#666;font-size:.17rem;font-weight:700}.formContent-box .row .row-right[data-v-6b54f369]{float:right;color:#ccc;font-size:.14rem}.formContent-box .row .row-right.active[data-v-6b54f369]{color:#333}.addDetail-box[data-v-6b54f369]{color:#6db1f1;line-height:.31rem;height:.31rem;text-align:center}.reasonContent-box[data-v-6b54f369]{height:1.23rem;margin:0 .1rem .1rem;border-radius:.09rem;background-color:#fff;padding:.13rem .15rem}.reasonContent-box textarea[data-v-6b54f369]{width:100%;height:100%;resize:none;border:none;outline:none}.reasonContent-box textarea[data-v-6b54f369]::-webkit-input-placeholder{color:#ccc}.reasonContent-box textarea[data-v-6b54f369]:-ms-input-placeholder,.reasonContent-box textarea[data-v-6b54f369]::-ms-input-placeholder{color:#ccc}.reasonContent-box textarea[data-v-6b54f369]::placeholder{color:#ccc}.commitBtn-box[data-v-6b54f369]{height:.5rem;margin:.3rem .1rem .1rem;background-color:#53a2ed;color:#fff;line-height:.5rem;font-size:.16rem;border-radius:.09rem;text-align:center}.mask-box[data-v-6b54f369]{position:fixed;left:0;top:0;right:0;bottom:0;background-color:#333;opacity:.3;z-index:10}.warn-box[data-v-6b54f369]{position:fixed;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:1.5rem;border:1px solid #000;border-radius:.05rem;text-align:center;background-color:#fff;z-index:11}.warn-box .title[data-v-6b54f369]{line-height:.36rem;font-size:.2rem;font-weight:700}.warn-box .content[data-v-6b54f369]{line-height:.3rem;font-size:.18rem}.warn-box .btn-box[data-v-6b54f369]{display:-webkit-flex;display:-ms-flexbox;display:flex}.warn-box .btn-box div[data-v-6b54f369]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;line-height:.34rem;font-weight:700}",""])},RGpD:function(t,e,o){var a=o("OzoW");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("cf0b839c",a,!0,{})},RQol:function(t,e,o){t.exports=o.p+"iconfont-approval.a499b45.ttf"},SMcQ:function(t,e,o){"use strict";o.r(e);var a=o("omC7"),i=o.n(a),n=o("lKpO"),r=o("74OJ"),s=o("fr9/"),c={data:function(){return{size:10,inputV:"",timer:null,processStateArr:["","审批中","已通过","未通过","已撤销"],leaveTypeList:[],biztripTypeList:[],isLoadAdd:!1,dataArr:[],showBg:!1}},computed:{begin:function(){return this.dataArr.length}},created:function(){var t=this;n.b.call(this,"leave").then(function(e){t.leaveTypeList=e}),n.b.call(this,"biztrip").then(function(e){t.biztripTypeList=e})},components:{LoaderRefresh:r.a},methods:{onClick:function(t){Object(s.a)(t.target,function(t){var e=t.classList;return!e.contains("refreshTop-container")&&(!e.contains("itemContent-box")&&void 0)})},loadData:function(t){var e=this,o=t.type,a=t.complete,i=t.vLoaderBottom;"refresh"===o?this.getDataList(0,this.size).then(function(t){e.dataArr=t||[],e.$nextTick(function(){i.reset(),i.tryLoad()}),a()}):this.getDataList(this.begin,this.size).then(function(t){var o=(t=t||[]).length;e.dataArr=e.dataArr.concat(t),e.$nextTick(function(){i.$el.offsetTop+90<window.innerHeight&&i.hide(),a(0===o)})})},itemAction:function(t,e,o){var a="0";a="1"===e?"2":"3","announce"!==o&&"attend_appeal"!==o||(a="3"===a?"0":a),this.$router.push({name:"approvalDetail",params:{id:t,type:a}})},searchAction:function(){var t=this;clearTimeout(this.timer),this.timer=setTimeout(function(){t.dataArr.map(function(e,o){-1===i()(e).indexOf(t.inputV)?e.isNotSearched=!0:e.isNotSearched=!1})},100)},getDataList:function(t,e){var o=this;return this.$axios.get("/mobicampus/approve/v1/getApplicationList?list_type=submitted&begin="+t+"&size="+e).then(function(e){var a=e.data;if(200===a.status){console.log("if-我提交的",a);var i=[],n=a.result.data.application_list;return o.showBg=0===t&&0===n.length,n.map(function(t){t.resource=t.resource||{};var e={};e.moduleCode=t.application.module_code,e.processState=t.application.process_state,e.curNodeState=t.application.state_processed,e.id=t.application.id,e.personName=t.resource.create_user_name;var a=t.application.create_time;if(e.time=o.$getTimeStr(a,"yy-mm hh:mm",!0),"leave"===t.application.module_code){e.event="请假",e.processState=t.application.process_state,e.processStateText=o.processStateArr[t.application.process_state];var n=t.resource.start_time.split("+")[0].split("T"),r=t.resource.end_time.split("+")[0].split("T"),s=t.resource.duration/8;e.contentArr=[["请假类型",t.resource.type_name],["请假时间",n[0]+"~"+r[0]],["请假时长",s+"天"]]}else if("biztrip"===t.application.module_code){e.event="外出",e.processState=t.application.process_state;var c=t.resource.start_time.split("+")[0].split("T"),l=t.resource.end_time.split("+")[0].split("T");e.contentArr=[["外出地点",t.resource.destination],["开始结束",c[0]+"~"+l[0]],["外出事由",t.resource.desc]]}else if("course_exchange_tk"===t.application.module_code)e.event="调课",e.processState=t.application.process_state,e.contentArr=[["调课事由",t.resource.reason]];else if("course_exchange_dnk"===t.application.module_code)e.event="顶课",e.processState=t.application.process_state,e.contentArr=[["顶课事由",t.resource.reason]];else if("announce"===t.application.module_code)e.event="公告",e.processState=t.application.process_state,e.contentArr=[["公告标题",t.resource.title],["公告类型",t.resource.type_name],["公告内容",t.resource.content]];else if("attend_appeal"===t.application.module_code){e.event="考勤申诉",e.processState=t.application.process_state,e.contentArr=[["异常日期",t.resource.date_to_clock.split("T")[0]],["异常情况",["","迟到","早退","正常","异常","缺卡"][t.resource.type]],["申诉理由",t.resource.reason]]}else"fund"===t.application.module_code?(e.event="经费",e.processState=t.application.process_state,e.contentArr=[["经费金额",t.resource.amount],["经费类型",t.resource.type_name],["经费事由",t.resource.desc]]):"assets_purchase"===t.application.module_code?(e.event="采购",e.processState=t.application.process_state,e.contentArr=[["采购事由",t.resource.desc],["采购金额",t.resource.amount]]):"car_using"===t.application.module_code?(e.event="用车",e.processState=t.application.process_state,e.contentArr=[["用车事由",t.resource.desc],["用车目的地",t.resource.destination],["用车人数",t.resource.number_of_people+"人"]]):"meeting"===t.application.module_code&&(e.event="会议",e.processState=t.application.process_state);e.isNotSearched=!1,i.push(e)}),i}}).catch(function(t){console.log(t)})}}},l=(o("NiyM"),o("hghu")),m=Object(l.a)(c,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"content-box commitCom"},[o("oa-bg-nodata",{directives:[{name:"show",rawName:"v-show",value:t.showBg,expression:"showBg"}]}),t._v(" "),o("div",{staticClass:"head-bg-box"}),t._v(" "),o("oa-search",{attrs:{position:"",keyword:t.inputV,placeholder:"搜索..."},on:{"update:keyword":function(e){t.inputV=e}}}),t._v(" "),o("LoaderRefresh",{attrs:{colorTop:"black",colorBottom:"black"},on:{loadData:t.loadData}},[o("div",{staticClass:"refreshTop-container",on:{click:t.onClick}},t._l(t.dataArr,function(e,a){return o("oa-listCom",{key:a,staticClass:"item-box",class:{searchActive:e.isNotSearched}},[o("div",{staticClass:"itemContent-box",on:{click:function(o){t.itemAction(e.id,e.processState,e.moduleCode)}}},[o("div",{staticClass:"title-box clearfix"},[o("p",{staticClass:"title"},[t._v(t._s(e.event))]),t._v(" "),o("span",{staticClass:"status",class:{"bg-blue":"1"===e.processState,"bg-red":"3"===e.processState,"bg-green":"2"===e.processState,"bg-gray":"4"===e.processState}},[t._v(t._s(t.processStateArr[e.processState]))]),t._v(" "),o("span",{staticClass:"time"},[t._v(t._s(e.time))])]),t._v(" "),t._l(e.contentArr,function(e,a){return o("div",{key:a,staticClass:"itemType"},[o("span",[t._v(t._s(e[0]))]),t._v("\n            ：\n            "),o("span",{staticClass:"contentText",domProps:{innerHTML:t._s(e[1])}},[t._v(t._s(e[1]))])])})],2)])}))])],1)},[],!1,null,"e7665e14",null);e.default=m.exports},SZ7W:function(t,e,o){"use strict";var a=o("u8gS");o.n(a).a},TRMM:function(t,e,o){var a=o("7QxT");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("247984b2",a,!0,{})},TxY5:function(t,e,o){"use strict";o.r(e);var a=o("Asgo"),i=o.n(a),n=o("hHQW"),r=o("8ffV"),s=o("8CNX"),c=o("KqdF"),l=o("lKpO"),m=o("p/l8"),d=o("TR4X"),p=o("cTMg"),u=o("kV9B"),f=o("xVKS"),h={data:function(){return{selectedData:{memberList:[],deptList:[],memberListSubmit:[]},canChangeProcess:!0,canChangeCcpeople:!0,isCommited:!1,bottomOptionsShow:!1,sectionList:[],memberA:!1,SlideSelectDateShow:!1,curUserId:"",userInfo:{},isShowconfirmBox:!1,formIndexActive:0,dateText:"",sectionText:"",teacherText:"",textareaText:"",approvalPersonArr:[],ccPersonArr:[],currActiveForm:null,formArr:[{dateText:"",sectionText:"",sectionArrIndex:"",sectionArr:[],teacherName:"",teacherId:""}]}},created:function(){this.getCurrUserInfo(),this.$route.params.id&&"0"!==this.$route.params.id?this.initData():this.getConf()},components:{CommitBtnCom:s.a,ApprovalProcessCom:p.a,SlideSelectDate:d.a,BottomOptions:f.a,MemberSelect:m.a,ccPersonCom:u.a,TextareaCom:c.a,FormCom:r.a,Cell:n.a},methods:{getConf:function(){var t=this;console.log("获取--请假审批模板"),l.a.call(this,"/mobicampus/course/v1/getMatchedApproveConf/course_exchange_dnk").then(function(e){t.canChangeProcess=e.canChangeProcess,t.approvalPersonArr=e.approvalPersonArr,t.canChangeCcpeople=e.canChangeCcpeople,t.ccPersonArr=e.ccPersonArr,t.selectedData.memberList=t.ccPersonArr})},onMemberAction:function(t){this.$refs.vMemberSelect.show({onConfirm:function(e){0!==e.memberList.length&&(t.user_name=e.memberList[0].user_name,t.user_id=e.memberList[0].user_id)}})},onSelectDirector:function(t){this.$refs.vMemberSelect.show({staticData:t.leader_list,onConfirm:function(e){0!==e.memberList.length&&(t.user_name=e.memberList[0].user_name,t.user_id=e.memberList[0].user_id)}})},selectDateAction:function(){this.SlideSelectDateShow=!0,this.currActiveForm.sectionText=""},onSectionSelect:function(){},onMemberSelect:function(){var t=this;this.$refs.vMemberSelect.show({type:"single",onConfirm:function(e){if(0!==e.memberList.length){var o=t.approvalPersonArr.length;if(o&&t.approvalPersonArr[o-1].user_id===e.memberList[0].user_id)return t.$simpleMsg("该成员与上级重复"),t.member=!0,!1;t.approvalPersonArr.push(e.memberList[0])}}})},onMemberSelectB:function(t){var e=this;this.$refs.vMemberSelect.show({type:"multiple",selectedData:this.selectedData,onConfirm:function(t){e.selectedData=t,e.ccPersonArr=t.memberListSubmit}})},addFormAction:function(){this.formArr.push({dateText:"",sectionText:"",curSectionId:"",sectionArrIndex:"",sectionArr:[],teacherName:"",teacherId:""})},delPopupAcion:function(t){this.formIndexActive=t,this.isShowconfirmBox=!0},onDelConfirm:function(){this.formArr.splice(this.formIndexActive,1),this.isShowconfirmBox=!1},dateConfirm:function(t){var e=this;this.currActiveForm.dateText=t,this.getCurriculum(t,this.curUserId).then(function(t){e.currActiveForm.sectionArr=t,e.sectionList=t})},selectSectionAction:function(t){var e=this;0===t.sectionArr.length&&this.getCurriculum(t.dateText,this.curUserId).then(function(o){t.sectionArr=o,e.sectionList=t.sectionArr}),this.sectionList=t.sectionArr,this.bottomOptionsShow=!0},bottomListAction:function(t,e){this.currActiveForm.sectionText=t.lesson_id_string+" "+t.subject_name,this.currActiveForm.sectionArrIndex=e,this.curSectionId=t.id,this.bottomOptionsShow=!1},onMemberSelectA:function(t){var e=this;this.$refs.vMemberSelect.show({selectedData:[],onConfirm:function(t){e.currActiveForm.teacherId=t.memberList[0].user_id,e.currActiveForm.teacherName=t.memberList[0].user_name}})},commitBtnAction:function(){if(!this.isCommited){for(var t=[],e=0;e<this.formArr.length;e++){var o=this.formArr[e],a=o.dateText,i=o.sectionText,n=o.teacherName,r=o.teacherId,s=o.sectionArr,c=o.sectionArrIndex;if(!a)return this.$simpleMsg("请选择表单"+(e+1)+"日期"),!1;if(!i)return this.$simpleMsg("请选择表单"+(e+1)+"节次"),!1;if(!n)return this.$simpleMsg("请选择表单"+(e+1)+"调课老师"),!1;if(!this.textareaText)return this.$simpleMsg("请填写顶课事由"),!1;if(0===this.approvalPersonArr.length)return this.$simpleMsg("请选择审批人"),!1;var l={from_date:a,from_curriculum_id:s[c].id,from_day_in_week:s[c].day_in_week,from_lesson_id:s[c].lesson_id,from_subject_id:s[c].subject_id,from_subject_name:s[c].subject_name,to_date:a,to_user_id:r,to_user_name:n};t.push(l)}var m={course_exchange:{type:2,reason:this.textareaText,details_list:t},node_list:this.approvalPersonArr,cc_people:this.ccPersonArr};this.isCommited=!0,this.postCreateApplication(m)}},postCreateApplication:function(t){var e=this;this.$preloaderFull.show(),this.$axios.post("/mobicampus/course/v1/createApplication",t).then(function(t){var o=t.data;e.$preloaderFull.close(),200===o.status?e.$router.replace({name:"commitCom"}):e.isCommited=!1}).catch(function(t){console.log(t)})},getCurrUserInfo:function(){var t=this;return this.$axios.get("/schoolorg/v1/getCurrUserInfo").then(function(e){var o=e.data,a=o.result.data;200===o.status&&(t.curUserId=a.user_id,t.userInfo=a)}).catch(function(t){console.log(t)})},getCurriculum:function(t,e){var o=this,a=t,n=e;return new i.a(function(t,e){o.$axios.get("/mobicampus/course/v1/getCurriculum/?date="+a+"&user_id="+n).then(function(e){var o=e.data,a=o.result.data;if(200===o.status){var i=[];a.map(function(t){i.push(t)}),t(i)}}).catch(function(t){console.log(t)})})},initData:function(){var t=this;this.formArr=[],this.$axios.get("/mobicampus/approve/v1/getApplicationDetails/"+this.$route.params.id).then(function(e){var o=e.data,a=o.result.data;if(200===o.status){var i=a.resource,n=a.process,r=a.application;t.formArr=[],t.curUserId=r.create_user_id,i.details_list.map(function(e){var o={dateText:e.from_date.split("+")[0].split("T")[0],sectionText:e.from_lesson_id_string+" "+e.from_subject_name,curSectionId:e.from_curriculum_id,sectionArrIndex:0,sectionArr:[{id:e.from_curriculum_id,day_in_week:e.from_day_in_week,lesson_id:e.from_lesson_id,lesson_id_string:e.from_lesson_id_string,subject_id:e.from_subject_id,subject_name:e.from_subject_name,user_id:e.to_user_id,user_name:e.to_user_name}],teacherName:e.to_user_name,teacherId:e.to_user_id};t.formArr.push(o)}),t.textareaText=i.reason,n.node_list.map(function(e,o){var a={user_name:e.user_name,user_id:e.user_id};0===o&&parseInt(e.user_id)===parseInt(t.curUserId)||t.approvalPersonArr.push(a)}),a.cc_people.map(function(e){var o={user_name:e.user_name,user_id:e.user_id};t.ccPersonArr.push(o)})}}).catch(function(t){console.log("error",t)})}}},v=(o("DHf9"),o("hghu")),b=Object(v.a)(h,function(){var t=this,e=this,o=e.$createElement,a=e._self._c||o;return a("div",{staticClass:" page-bg dingke"},[e._l(e.formArr,function(t,o){return a("div",{key:o,staticClass:"form-box",on:{click:function(a){e.formIndexActive=o,e.currActiveForm=t}}},[a("FormCom",[a("cell",{attrs:{button:"",title:"日期",content:t.dateText},on:{action:e.selectDateAction}}),e._v(" "),a("cell",{attrs:{button:"",title:"节次",content:t.sectionText},on:{action:function(){return e.selectSectionAction(t)}}}),e._v(" "),a("cell",{attrs:{button:"",title:"顶课老师",content:t.teacherName},on:{action:e.onMemberSelectA}})],1),e._v(" "),a("div",{staticClass:"addAndDel-box"},[a("div",{directives:[{name:"show",rawName:"v-show",value:o===e.formArr.length-1,expression:"index === formArr.length - 1"}],staticClass:"addBtn"},[a("span",{staticClass:"iconfont-approval"},[e._v("")]),e._v(" "),a("span",{staticClass:"text",on:{click:e.addFormAction}},[e._v("添加")])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1!==e.formArr.length,expression:"formArr.length !== 1"}],staticClass:"delBtn"},[a("span",{staticClass:"iconfont-approval"},[e._v("")]),e._v(" "),a("span",{staticClass:"text",on:{click:function(t){e.delPopupAcion(o)}}},[e._v("删除")])])])],1)}),e._v(" "),a("TextareaCom",{attrs:{placeholder:"请输入顶课事由",content:e.textareaText},on:{"update:content":function(t){e.textareaText=t}}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowconfirmBox,expression:"isShowconfirmBox"}],staticClass:"mask-box"}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowconfirmBox,expression:"isShowconfirmBox"}],staticClass:"warn-box"},[a("div",{staticClass:"title"},[e._v("提示")]),e._v(" "),a("div",{staticClass:"content"},[e._v("确定删除？")]),e._v(" "),a("div",{staticClass:"btn-box"},[a("div",{staticClass:"confirmBtn",on:{click:function(){return t.isShowconfirmBox=!1}}},[e._v("取消")]),e._v(" "),a("div",{staticClass:"confirmBtn",on:{click:e.onDelConfirm}},[e._v("确定")])])]),e._v(" "),a("ApprovalProcessCom",{attrs:{needDelBtn:e.canChangeProcess,needAddBtn:e.canChangeProcess,needArrow:!0,approvalPersonArr:e.approvalPersonArr},on:{addPerson:e.onMemberSelect,selectDirector:e.onSelectDirector,memberAction:e.onMemberAction}}),e._v(" "),a("ccPersonCom",{attrs:{ccPersonArr:e.ccPersonArr},on:{addPerson:e.onMemberSelectB}}),e._v(" "),a("CommitBtnCom",{on:{action:e.commitBtnAction}}),e._v(" "),a("MemberSelect",{ref:"vMemberSelect"}),e._v(" "),a("SlideSelectDate",{attrs:{show:e.SlideSelectDateShow,value:e.dateText},on:{curPageConfirm:e.dateConfirm,"update:show":function(t){e.SlideSelectDateShow=t},"update:value":function(t){e.dateText=t},error:function(t){e.timeError("发生未知错误")}}}),e._v(" "),a("BottomOptions",{attrs:{show:e.bottomOptionsShow},on:{select:e.onSectionSelect,"update:show":function(t){e.bottomOptionsShow=t}}},[a("ul",e._l(e.sectionList,function(t,o){return a("li",{key:o+"33",attrs:{"data-type":o},on:{click:function(){return e.bottomListAction(t,o)}}},[e._v(e._s(t.lesson_id_string+" "+t.subject_name))])}))])],2)},[],!1,null,"6b54f369",null);e.default=b.exports},UKXv:function(t,e,o){"use strict";o.r(e);var a=o("hHQW"),i=o("8ffV"),n=o("8CNX"),r=o("KqdF"),s=o("p/l8"),c=o("lKpO"),l=o("5q1O"),m=o("cTMg"),d=o("kV9B"),p=o("6UnF"),u={components:{CommitBtnCom:n.a,MemberSelect:s.a,SlideSelectDate:l.a,ApprovalProcessCom:m.a,ccPersonCom:d.a,AttachmentCom:p.a,TextareaCom:r.a,Cell:a.a,FormCom:i.a},data:function(){return{isCommited:!1,selectedData:{memberList:[],deptList:[],memberListSubmit:[]},canChangeProcess:!0,canChangeCcpeople:!0,totalNum:"",imgList:[],fileList:[],attachmentList:[],approvalPersonArr:[],ccPersonArr:[],textareaText:"",site:"",dateSelA:"",dateSelB:"",bottomOptionsShow:!1,SlideSelectDateShowA:!1,SlideSelectDateShowB:!1}},watch:{dateSelA:function(){this.dateSelA&&this.dateSelB&&this.getConf()},dateSelB:function(){this.dateSelA&&this.dateSelB&&this.getConf()}},created:function(){this.$route.query.detailData&&this.initData()},methods:{initData:function(){var t=this.$route.query.detailData;console.log(t);var e=t.resource,o=t.process,a=t.cc_people;this.totalNum=e.number_of_people,this.dateSelA=this.$getTimeStr(e.setoff_time,"yy-mm-dd hh:mm",!1).replace(" ","  "),this.dateSelB=this.$getTimeStr(e.getback_time,"yy-mm-dd hh:mm",!1).replace(" ","  "),this.site=e.destination,this.textareaText=e.desc,this.approvalPersonArr=o.node_list.map(function(t){return{user_name:t.user_name,user_id:t.user_id}}),this.ccPersonArr=a.map(function(t){return{user_name:t.user_name,user_id:t.user_id}})},getConf:function(){var t=this;console.log("获取--请假审批模板"),c.a.call(this,"/mobicampus/car/v1/carusing/approveconf/match").then(function(e){t.canChangeProcess=e.canChangeProcess,t.approvalPersonArr=e.approvalPersonArr,t.canChangeCcpeople=e.canChangeCcpeople,t.ccPersonArr=e.ccPersonArr})},onMemberSelectB:function(t){var e=this;console.log("this.ccPersonArr",this.ccPersonArr),this.$refs.vMemberSelect.show({type:"multiple",selectedData:this.selectedData,onConfirm:function(t){e.selectedData=t,e.ccPersonArr=t.memberListSubmit}})},commitBtnAction:function(){var t=this.totalNum,e=this.dateSelA,o=this.dateSelB,a=this.site,i=this.textareaText,n=this.approvalPersonArr;return t?e?o?a?i?n.length?void this.postData():(this.$simpleMsg("请选择审批人"),!1):(this.$simpleMsg("请输入用车理由"),!1):(this.$simpleMsg("请输入目的地"),!1):(this.$simpleMsg("请选择回程时间"),!1):(this.$simpleMsg("请选择出发时间"),!1):(this.$simpleMsg("请输入总人数"),!1)},postData:function(){var t=this,e={car_using:{number_of_people:this.totalNum,setoff_time:this.dateSelA,getback_time:this.dateSelB,destination:this.site,desc:this.textareaText},node_list:this.approvalPersonArr,cc_people:this.ccPersonArr};return this.$preloaderFull.show(),this.$axios.post("/mobicampus/car/v1/carusing/application/create",e).then(function(e){var o=e.data;t.$preloaderFull.close(),200===o.status&&t.$router.replace({name:"commitCom"})})}}},f=(o("rEbm"),o("hghu")),h=Object(f.a)(u,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"yongche  page-bg"},[o("FormCom",[o("cell",{attrs:{input:"",type:"number",title:"总人数",content:t.totalNum,placeholder:"填写数字"},on:{"update:content":function(e){t.totalNum=e}}}),t._v(" "),o("cell",{attrs:{button:"",title:"出发时间",content:t.dateSelA},on:{action:function(){return t.SlideSelectDateShowA=!0}}}),t._v(" "),o("cell",{attrs:{button:"",title:"回程时间",content:t.dateSelB},on:{action:function(){return t.SlideSelectDateShowB=!0}}}),t._v(" "),o("cell",{attrs:{input:"",title:"目的地",content:t.site,placeholder:"填写位置"},on:{"update:content":function(e){t.site=e}}})],1),t._v(" "),o("TextareaCom",{attrs:{placeholder:"请输入用车事由",content:t.textareaText},on:{"update:content":function(e){t.textareaText=e}}}),t._v(" "),o("oa-approvalProcess",{attrs:{needArrow:!0,needDelBtn:t.canChangeProcess,needAddBtn:t.canChangeProcess,approvalPersonArr:t.approvalPersonArr}}),t._v(" "),o("ccPersonCom",{attrs:{needDelBtn:t.canChangeCcpeople,needAddBtn:t.canChangeCcpeople,ccPersonArr:t.ccPersonArr},on:{addPerson:t.onMemberSelectB}}),t._v(" "),o("attachmentCom",{attrs:{imgList:t.imgList}}),t._v(" "),o("CommitBtnCom",{on:{action:t.commitBtnAction}}),t._v(" "),o("SlideSelectDate",{attrs:{show:t.SlideSelectDateShowA,value:t.dateSelA,maxValue:t.dateSelB},on:{"update:show":function(e){t.SlideSelectDateShowA=e},"update:value":function(e){t.dateSelA=e},error:function(e){t.timeError("开始时间不能晚于结束时间")}}}),t._v(" "),o("SlideSelectDate",{attrs:{show:t.SlideSelectDateShowB,value:t.dateSelB,minValue:t.dateSelA},on:{"update:show":function(e){t.SlideSelectDateShowB=e},"update:value":function(e){t.dateSelB=e},error:function(e){t.timeError("结束时间不能早于开始时间")}}}),t._v(" "),o("MemberSelect",{ref:"vMemberSelect"})],1)},[],!1,null,"46792b5b",null);e.default=h.exports},VcGb:function(t,e,o){"use strict";var a=o("1Svp");o.n(a).a},Vs3L:function(t,e,o){"use strict";var a=o("YBOc");o.n(a).a},WISY:function(t,e,o){var a=o("X3X9");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("768f1a83",a,!0,{})},X3X9:function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,"",""])},X4hB:function(t,e,o){"use strict";var a=o("6Yjp");o.n(a).a},"Y/JG":function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,".tiaoke[data-v-f9c71966]{padding-top:.12rem;padding-bottom:.54rem}.form-box[data-v-f9c71966]{-webkit-transform:translate(0);-ms-transform:translate(0);transform:translate(0)}.form-box .addAndDel-box[data-v-f9c71966]{padding:0 .8rem;display:-webkit-flex;display:-ms-flexbox;display:flex;text-align:center;line-height:.3rem}.form-box .addAndDel-box .addBtn[data-v-f9c71966]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;color:#6db1f1}.form-box .addAndDel-box .delBtn[data-v-f9c71966]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;color:red}.formContent-box[data-v-f9c71966]{-webkit-transform:translate(0);-ms-transform:translate(0);transform:translate(0);margin:0 .1rem;background-color:#fff}.formContent-box .row[data-v-f9c71966]{-webkit-box-sizing:border-box;box-sizing:border-box;height:.54rem;line-height:.52rem;padding:0 .1rem 0 .19rem}.formContent-box .row .row-left[data-v-f9c71966]{float:left;color:#666;font-size:.17rem;font-weight:700}.formContent-box .row .row-right[data-v-f9c71966]{float:right;color:#ccc;font-size:.14rem}.formContent-box .row .row-right.active[data-v-f9c71966]{color:#333}.addDetail-box[data-v-f9c71966]{color:#6db1f1;line-height:.31rem;height:.31rem;text-align:center}.reasonContent-box[data-v-f9c71966]{height:1.23rem;margin:0 .1rem .1rem;border-radius:.09rem;background-color:#fff;padding:.13rem .15rem}.reasonContent-box textarea[data-v-f9c71966]{width:100%;height:100%;resize:none;border:none;outline:none}.reasonContent-box textarea[data-v-f9c71966]::-webkit-input-placeholder{color:#ccc}.reasonContent-box textarea[data-v-f9c71966]:-ms-input-placeholder,.reasonContent-box textarea[data-v-f9c71966]::-ms-input-placeholder{color:#ccc}.reasonContent-box textarea[data-v-f9c71966]::placeholder{color:#ccc}.commitBtn-box[data-v-f9c71966]{height:.5rem;margin:.3rem .1rem .1rem;background-color:#53a2ed;color:#fff;line-height:.5rem;font-size:.16rem;border-radius:.09rem;text-align:center}.mask-box[data-v-f9c71966]{position:fixed;left:0;top:0;right:0;bottom:0;background-color:#333;opacity:.3;z-index:10}.warn-box[data-v-f9c71966]{position:fixed;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:1.5rem;border:1px solid #000;border-radius:.05rem;text-align:center;background-color:#fff;z-index:11}.warn-box .title[data-v-f9c71966]{line-height:.36rem;font-size:.2rem;font-weight:700}.warn-box .content[data-v-f9c71966]{line-height:.3rem;font-size:.18rem}.warn-box .btn-box[data-v-f9c71966]{display:-webkit-flex;display:-ms-flexbox;display:flex}.warn-box .btn-box div[data-v-f9c71966]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;line-height:.34rem;font-weight:700}.changeBtn-box[data-v-f9c71966]{height:.31rem;line-height:.31rem;text-align:center;background-color:#efefef;color:#6db1f1;font-size:.16rem}",""])},YBOc:function(t,e,o){var a=o("Jua+");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("7e1bfa00",a,!0,{})},Ylvx:function(t,e,o){"use strict";var a=o("TRMM");o.n(a).a},"Z+XW":function(t,e,o){"use strict";o.r(e);var a=o("Asgo"),i=o.n(a),n={data:function(){return{keyboartActive:!1,inputText:"",btnList:[{content:"同意",fn:"agreeAction"},{content:"驳回",fn:"rejectAction"},{content:"转审",fn:"transferAction"}]}},computed:{isCanSend:function(){return this.inputText.length>0}},methods:{btnAction:function(t,e){this.$emit(t.fn)},keyboartAction:function(){this.keyboartActive=!this.keyboartActive,this.keyboartActive&&(this.$refs.ipt.autofocus=!0)},enterAction:function(){},sendAction:function(){if(!this.isCanSend)return!1;this.$emit("sendOpinionAction",this.inputText),this.inputText=""}}},r=(o("SZ7W"),o("hghu")),s=Object(r.a)(n,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"buttom-operation-box top-one-px"},[o("div",{staticClass:"keyboart-btn",on:{click:t.keyboartAction}},[o("span",{staticClass:"iconfont-approval",class:{active:t.keyboartActive}},[t._v("")])]),t._v(" "),o("ul",{directives:[{name:"show",rawName:"v-show",value:!t.keyboartActive,expression:"!keyboartActive"}],staticClass:"list"},t._l(t.btnList,function(e,a){return o("li",{key:a,staticClass:"item",on:{click:function(o){t.btnAction(e,a)}}},[t._v(t._s(e.content))])})),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.keyboartActive,expression:"keyboartActive"}],staticClass:"input-box",on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.enterAction(e):null}}},[o("div",{staticClass:"inputContent-box"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.inputText,expression:"inputText"}],ref:"ipt",attrs:{type:"text"},domProps:{value:t.inputText},on:{input:function(e){e.target.composing||(t.inputText=e.target.value)}}}),t._v(" "),o("span",{staticClass:"sendText",class:{active:t.isCanSend},on:{click:t.sendAction}},[t._v("发送")])])])])},[],!1,null,"70ada76a",null).exports,c={data:function(){return{keyboartActive:!1,inputText:"",btnList:[{content:"催办",fn:"urgeAction"},{content:"撤销",fn:"revokeAction"}]}},computed:{isCanSend:function(){return this.inputText.length>0}},methods:{btnAction:function(t,e){this.$emit(t.fn)},keyboartAction:function(){this.keyboartActive=!this.keyboartActive,this.keyboartActive&&(this.$refs.ipt.autofocus=!0)},sendAction:function(){if(!this.isCanSend)return!1;this.$emit("sendOpinionAction",this.inputText),this.inputText=""}}},l=(o("gSaW"),Object(r.a)(c,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"buttom-operation-box top-one-px"},[o("div",{staticClass:"keyboart-btn",on:{click:t.keyboartAction}},[o("span",{staticClass:"iconfont-approval",class:{active:t.keyboartActive}},[t._v("")])]),t._v(" "),o("ul",{directives:[{name:"show",rawName:"v-show",value:!t.keyboartActive,expression:"!keyboartActive"}],staticClass:"list"},t._l(t.btnList,function(e,a){return o("li",{key:a,staticClass:"item clickActive",on:{click:function(o){t.btnAction(e,a)}}},[t._v(t._s(e.content))])})),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.keyboartActive,expression:"keyboartActive"}],staticClass:"input-box",on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.enterAction(e):null}}},[o("div",{staticClass:"inputContent-box"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.inputText,expression:"inputText"}],ref:"ipt",attrs:{type:"text"},domProps:{value:t.inputText},on:{input:function(e){e.target.composing||(t.inputText=e.target.value)}}}),t._v(" "),o("span",{staticClass:"sendText",class:{active:t.isCanSend},on:{click:t.sendAction}},[t._v("发送")])])])])},[],!1,null,"a60e7a92",null).exports),m={data:function(){return{keyboartActive:!1,inputText:""}},computed:{isCanSend:function(){return this.inputText.length>0}},methods:{keyboartAction:function(){this.keyboartActive=!this.keyboartActive},resubmitAction:function(){this.$emit("resubmitAction")},sendAction:function(){if(!this.isCanSend)return!1}}},d=(o("JocO"),Object(r.a)(m,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"buttom-operation-box  top-one-px"},[e("div",{directives:[{name:"show",rawName:"v-show",value:!this.keyboartActive,expression:"!keyboartActive"}],staticClass:"urge-btn",on:{click:this.resubmitAction}},[this._v("重新提交")])])},[],!1,null,"1ef6e811",null).exports),p={data:function(){return{inputText:""}},computed:{isCanSend:function(){return this.inputText.length>0}},methods:{sendAction:function(){if(!this.isCanSend)return!1;this.$emit("sendOpinionAction",this.inputText),this.inputText=""}}},u=(o("MQfr"),Object(r.a)(p,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"buttom-operation-box top-one-px"},[t._m(0),t._v(" "),o("div",{staticClass:"input-box"},[o("div",{staticClass:"inputContent-box"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.inputText,expression:"inputText"}],attrs:{type:"text"},domProps:{value:t.inputText},on:{input:function(e){e.target.composing||(t.inputText=e.target.value)}}}),t._v(" "),o("span",{staticClass:"sendText",class:{active:t.isCanSend},on:{click:t.sendAction}},[t._v("发送")])])])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"keyboart-btn"},[e("span",{staticClass:"iconfont-approval"},[this._v("")])])}],!1,null,"51e32140",null).exports),f={props:{processData:{type:Array}},data:function(){return{statusArr:["待审批","","审批通过","审批未通过","已撤销","已转交"]}}},h=(o("VcGb"),Object(r.a)(f,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"processContent-box"},[o("div",{staticClass:"processContent-head"},[t._v("审批流程")]),t._v(" "),o("ul",{staticClass:"processList"},t._l(t.processData,function(e,a){return o("li",{key:"processItem"+a,staticClass:"processItem"},[o("div",{staticClass:"img-box processItem-left"}),t._v(" "),o("div",{staticClass:"content-box processItem-right"},[o("div",{staticClass:"personName-box cf"},[o("span",{staticClass:"personName"},[t._v(t._s(e.personName))]),t._v(" "),o("div",{staticClass:"viewText",class:{"color-blue":"0"===e.status||"5"===e.status,"color-gray":"4"===e.status,"color-red":"3"===e.status,"color-green":"2"===e.status}},[t._v(t._s(t.statusArr[e.status]))]),t._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:"0"!==e.status,expression:"item.status !== '0'"}],staticClass:"time"},[t._v(t._s(e.time))])]),t._v(" "),t._l(e.opinionList,function(e,a){return o("div",{key:"opinionList"+a,staticClass:"opinionList"},[o("span",{staticClass:"personName"},[t._v(t._s(e.personName)+"：")]),t._v(" "),o("span",{staticClass:"contentText"},[t._v(t._s(e.contentText))])])})],2)])}))])},[],!1,null,"17a272e0",null).exports),v=o("k0ul"),b={props:{data:{type:Object}}},x=(o("oQCK"),{components:{infoCaigou:Object(r.a)(b,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"info-caigou"},[t._l(t.data.contentArr,function(e,a){return o("div",{key:"contentArr"+a,staticClass:"row"},[o("div",{staticClass:"l"},[t._v(t._s(e[0]+":"))]),t._v(" "),o("div",{staticClass:"r"},[t._v(t._s(e[1]))])])}),t._v(" "),t._l(t.data.formList,function(e,a){return o("div",{key:"formList"+a,staticClass:"form"},[o("div",{staticClass:"head"},[t._v(t._s("明细清单"+(a+1)))]),t._v(" "),t._l(e,function(e,a){return o("div",{key:"list"+a,staticClass:"row"},[o("div",{staticClass:"l"},[t._v(t._s(e[0]+":"))]),t._v(" "),o("div",{staticClass:"r"},[t._v(t._s(e[1]))])])})],2)})],2)},[],!1,null,"0aa36ee5",null).exports},props:{dataObj:{type:Object},displayModule:{type:String}},data:function(){return{isSpread:!1}},methods:{imgAction:function(t){var e=this.dataObj.attachmentArr[0].map(function(t){return t.src});Object(v.c)(e,t)}}}),g=(o("qkpI"),Object(r.a)(x,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"detailContent-box"},[o("div",{staticClass:"personInfo"},[o("div",{staticClass:"personImg personInfo-left"}),t._v(" "),o("div",{staticClass:"personInfo-right"},[o("p",{staticClass:"personName"},[t._v(t._s(t.dataObj.personName))]),t._v(" "),o("p",{staticClass:"status",class:{"color-orange":"1"===t.dataObj.status.state,"color-green":"2"===t.dataObj.status.state,"color-red":"3"===t.dataObj.status.state,"color-gray":"4"===t.dataObj.status.state}},[t._v(t._s(t.dataObj.status.contentText))])])]),t._v(" "),"normal"===t.displayModule?o("div",{staticClass:"infoContent-box"},t._l(t.dataObj.contentArr,function(e,a){return o("div",{key:"normal"+a,staticClass:"info-row",class:{specialStyle:"specialStyle"===e.specialStyle}},[o("div",{staticClass:"keyText"},[t._v(t._s(e[0]+":"))]),t._v(" "),o("div",{staticClass:"valueText",domProps:{innerHTML:t._s(e[1])}})])})):t._e(),t._v(" "),"announceModule"===t.displayModule?o("div",{staticClass:"infoContent-box"},[t._l(t.dataObj.contentArr,function(e,a){return o("div",{key:"announceModule"+a,staticClass:"info-row",class:{specialStyle:"specialStyle"===e.specialStyle}},[o("div",{staticClass:"keyText"},[t._v(t._s(e[0]+":"))]),t._v(" "),o("div",{staticClass:"valueText"},[t._v(t._s(e[1]))])])}),t._v(" "),o("div",{staticClass:"info-row notice-row"},[o("div",{staticClass:"keyText"},[t._v("通知对象:")]),t._v(" "),o("div",{staticClass:"valueText",class:{active:!t.isSpread}},t._l(t.dataObj.noticePersonArr,function(e,a){return o("span",{key:"personName"+a,staticClass:"personName"},[t._v(t._s(e))])})),t._v(" "),t.dataObj.noticePersonArr.length>4?o("span",{staticClass:"switchBtn",on:{click:function(){t.isSpread=!t.isSpread}}},[t._v(t._s(t.isSpread?"收起":"展开"))]):t._e()])],2):t._e(),t._v(" "),"caigou"===t.displayModule?o("info-caigou",{attrs:{data:t.dataObj}}):t._e(),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.dataObj.attachmentArr[0].length+t.dataObj.attachmentArr[1].length,expression:"dataObj.attachmentArr[0].length + dataObj.attachmentArr[1].length"}],staticClass:"attachment-box"},[o("span",[t._v("说明附件：")]),t._v(" "),o("div",{staticClass:"attachment"},[o("div",{staticClass:"attachmentImgs-box cf"},t._l(t.dataObj.attachmentArr[0],function(e,a){return o("div",{key:"imgbox"+a,staticClass:"img-box",on:{click:function(e){t.imgAction(a)}}},[o("img",{attrs:{src:e.src}})])})),t._v(" "),o("div",{staticClass:"attachmentDocuments-box cf"},t._l(t.dataObj.attachmentArr[1],function(e,a){return o("div",{key:a,staticClass:"document-box"},[o("a",{attrs:{href:e.src}},[t._v(t._s(e.name))])])}))])])],1)},[],!1,null,"4eee0380",null).exports),_=o("p/l8"),C=o("lKpO"),A=o("OZ6h"),w={data:function(){return{detailData:null,isSpread:!1,displayModule:"",applicationType:"",isShowRevokeConfirmBox:!1,isShowWarnBox:!1,processStateArr:["","审批中","申请已通过","申请未通过","申请已撤销"],statusArr:["待审批","","审批通过","审批未通过","已撤销","已转交"],leaveTypeList:[],biztripTypeList:[],dataObj:{noticePersonArr:[],personName:"",processId:"",status:{contentText:"",state:""},contentArr:[],attachmentArr:[[],[]]},processData:[]}},components:{detailInfoCom:g,processCom:h,btmOperComA:s,btmOperComB:l,btmOperComC:d,btmOperComD:u,MemberSelect:_.a,confirmBoxCom:A.a},created:function(){var t=this,e=C.b.call(this,"leave").then(function(e){t.leaveTypeList=e}),o=C.b.call(this,"biztrip").then(function(e){t.biztripTypeList=e});i.a.all([e,o]).then(function(){t.refresh()})},methods:{onAgree:function(){var t=this,e={process_id:this.dataObj.processId,action:"pass"};this.postApproveOpinion(e).then(function(e){t.$simpleMsg("已同意")})},onReject:function(){var t=this;this.isShowWarnBox=!1;var e={process_id:this.dataObj.processId,action:"reject"};this.postApproveOpinion(e).then(function(e){t.$simpleMsg("已驳回")})},onSendOpinion:function(t){var e=this,o={process_id:this.dataObj.processId,content:t};this.$axios.post("/mobicampus/approve/v1/addApproveOpinion",o).then(function(t){200===t.data.status&&e.refresh()})},onTransfer:function(){var t=this;this.$refs.vMemberSelect.show({type:"single",selectedData:null,onConfirm:function(e){var o={process_id:t.dataObj.processId,action:"transfer",approve_transfer:{to_user_id:e.memberListSubmit[0].user_id,to_user_name:e.memberListSubmit[0].user_name}};t.postApproveOpinion(o).then(function(e){t.$simpleMsg("已转审")})}})},onUrge:function(){},onRevokeConfirm:function(){this.postRevoke()},postRevoke:function(){var t=this,e={process_id:this.dataObj.processId,action:"undo"};this.postApproveOpinion(e).then(function(e){t.isShowRevokeConfirmBox=!1,t.$simpleMsg("已撤销")})},onResubmit:function(){this.postRevoke(),this.$router.push({name:this.applicationType,params:{id:this.$route.params.id},query:{detailData:this.detailData}})},postApproveOpinion:function(t){var e=this;return this.$axios.post("/mobicampus/approve/v1/approve",t).then(function(t){200===t.data.status&&e.$router.back()}).catch(function(t){console.log(t)})},refresh:function(){var t=this;this.$axios.get("/mobicampus/approve/v1/getApplicationDetails/"+this.$route.params.id).then(function(e){var o=e.data,a=o.result.data;if(t.detailData=a,200===o.status){console.log("详情页",a),t.processData=[];var i=a.resource,n=a.process,r=a.application;if(t.dataObj={noticePersonArr:[],personName:n.create_user_name,processId:n.id,status:{contentText:t.processStateArr[n.state],state:n.state},contentArr:[],attachmentArr:[[],[]]},i.attachment_list&&i.attachment_list.map(function(e,o){var a=Object(v.b)(e.name),i={name:e.name,src:e.src};"41"===a?t.dataObj.attachmentArr[0].push(i):"31"===a&&t.dataObj.attachmentArr[1].push(i)}),"leave"===r.module_code){t.displayModule="normal",t.applicationType="qingjia";var s=i.start_time.split("+")[0].split("T"),c=i.end_time.split("+")[0].split("T");s[1]="07:50:00"===s[1]?"上午":"下午",c[1]="12:00:00"===c[1]?"上午":"下午";var l=i.duration/8;t.dataObj.contentArr=[["请假类型",i.type_name],["请假时长",l+"天"],["开始时间",s[0]+" "+s[1]],["结束时间",c[0]+" "+c[1]],["请假原因",i.reason]]}else if("biztrip"===r.module_code){t.displayModule="normal",t.applicationType="waichu";var m=i.start_time.split("+")[0].split("T"),d=i.end_time.split("+")[0].split("T");m[1]="07:50:00"===m[1]?"上午":"下午",d[1]="12:00:00"===d[1]?"上午":"下午",t.dataObj.contentArr=[["外出类型",i.type_name],["开始时间",m[0]+" "+m[1]],["结束时间",d[0]+" "+d[1]],["目的地",i.destination],["外出事由",i.desc]]}else if("course_exchange_tk"===r.module_code)t.displayModule="normal",t.applicationType="tiaoke",t.dataObj.contentArr=[],i.details_list.map(function(e,o){var a=["换课申请"+(o+1),""];a.specialStyle="specialStyle";var i=e.from_date.split("+")[0].split("T")[0],n=e.to_date.split("+")[0].split("T")[0];t.dataObj.contentArr.push(a),t.dataObj.contentArr.push(["日期",i+" <-> "+n]),t.dataObj.contentArr.push(["节次",e.from_lesson_id_string+" <-> "+e.to_lesson_id_string]),t.dataObj.contentArr.push(["科目",e.from_subject_name+" <-> "+e.to_subject_name]),t.dataObj.contentArr.push(["老师",e.from_user_name+" <-> "+e.to_user_name])});else if("course_exchange_dnk"===r.module_code)t.displayModule="normal",t.applicationType="dingke",t.dataObj.contentArr=[],i.details_list.map(function(e,o){var a=["顶课申请"+(o+1),""];a.specialStyle="specialStyle";var i=e.from_date.split("+")[0].split("T")[0];t.dataObj.contentArr.push(a),t.dataObj.contentArr.push(["日期",i]),t.dataObj.contentArr.push(["节次",e.from_lesson_id_string]),t.dataObj.contentArr.push(["科目",e.from_subject_name]),t.dataObj.contentArr.push(["老师",e.to_user_name])});else if("announce"===r.module_code){t.displayModule="announceModule",t.applicationType="inform";var p=[];i.notif_people_havnt_read.map(function(t){p.push(t.user_name)}),p.push("等"+i.notif_people_havnt_read.length+"人"),t.dataObj.contentArr=[["公告标题",i.announce.title],["公告类型",i.announce.type_name],["公告内容",i.announce.content]],t.dataObj.noticePersonArr=p,i.announce.attachment_list.map(function(e,o){var a=Object(v.b)(e.name),i={name:e.name,src:e.src};"41"===a?t.dataObj.attachmentArr[0].push(i):"31"===a&&t.dataObj.attachmentArr[1].push(i)})}else if("attend_appeal"===r.module_code){t.displayModule="normal",t.applicationType="appeal";t.dataObj.contentArr=[["异常日期",i.date_to_clock.split("T")[0]],["异常情况",["","迟到","早退","正常","异常","缺卡"][i.type]+" 上班时间："+i.time_to_clock+" 打卡时间："+(i.old_clock_time||"无")],["申诉理由",i.reason]]}else"fund"===r.module_code?(t.displayModule="normal",t.applicationType="jingfei",t.dataObj.contentArr=[["经费金额",i.amount],["经费类型",i.type_name],["经费事由",i.desc]]):"assets_purchase"===r.module_code?(t.displayModule="caigou",t.applicationType="caigou",t.dataObj.contentArr=[["采购事由",i.desc],["采购金额",i.amount]],t.dataObj.formList=i.item_list.map(function(t){return[["品名",t.name],["规格",t.spec],["单价",t.unit_price],["数量",t.total]]})):"car_using"===r.module_code&&(t.displayModule="normal",t.applicationType="yongche",t.dataObj.contentArr=[["用车人数",i.number_of_people+"人"],["用车事由",i.desc],["出发时间",t.$getTimeStr(i.setoff_time,"yy-mm-dd hh:mm",!1)],["回程时间",t.$getTimeStr(i.getback_time,"yy-mm-dd hh:mm",!1)],["目的地",i.destination],["用车事由",i.desc]]);n.node_list.map(function(e,o){"1"===n.state&&e.id===n.curr_node_id&&(t.dataObj.status.contentText="等待"+e.user_name+"的审批");var a=e.time_processed.split("+")[0].split("T"),i=a[0].indexOf("-");a[0]=a[0].slice(i+1);var r=a[1].lastIndexOf(":");a[1]=a[1].slice(0,r);var s=(new Date).toDateString()===new Date(a[0]).toDateString()?a[1]:a[0]+" "+a[1],c={status:e.state_processed,personName:e.user_name,time:s,contentText:t.processStateArr[e.state_processed],opinionList:[]};c.opinionList=e.opinion_list.map(function(t,e){return{personName:t.user_name,contentText:t.content}}),t.processData.push(c)})}}).catch(function(t){console.log(t)}).then(function(){t.isLoadAdd=!1})},checkFileType:function(t){for(var e=t.lastIndexOf("."),o=t.substring(e).toLowerCase(),a=[".jpg",".gif",".png",".jpeg"],i=0;i<a.length;i++)if(a[i]===o)return"41";for(var n=[".txt",".doc",".docx",".xls",".xlsx",".pdf",".ppt",".pptx",".rar",".zip"],r=0;r<n.length;r++)if(n[r]===o)return"31";for(var s=[".flv",".3gp",".avi",".rmvb",".rm",".divx",".mpg",".mpeg",".mpe",".wmv",".mp4",".mkv",".vob"],c=0;c<s.length;c++)if(s[c]===o)return"11";for(var l=[".cd",".ogg",".mp3",".asf",".wma",".wav",".mp3pro",".midi",".vqf"],m=0;m<l.length;m++)if(l[m]===o)return"21";return"51"}}},S=(o("tuFf"),Object(r.a)(w,function(){var t=this,e=this,o=e.$createElement,a=e._self._c||o;return a("div",{staticClass:"ChildPage approvalDetail page-bg page-fixed"},[a("detailInfoCom",{attrs:{dataObj:e.dataObj,displayModule:e.displayModule}}),e._v(" "),a("processCom",{attrs:{processData:e.processData}}),e._v(" "),"1"===this.$route.params.type?a("btmOperComA",{on:{agreeAction:e.onAgree,rejectAction:function(){return t.isShowWarnBox=!0},transferAction:e.onTransfer,sendOpinionAction:e.onSendOpinion}}):"2"===this.$route.params.type?a("btmOperComB",{on:{revokeAction:function(t){e.isShowRevokeConfirmBox=!0},urgeAction:e.onUrge,sendOpinionAction:e.onSendOpinion}}):"3"===this.$route.params.type?a("btmOperComC",{on:{resubmitAction:e.onResubmit}}):"4"===this.$route.params.type?a("btmOperComD",{on:{sendOpinionAction:e.onSendOpinion}}):e._e(),e._v(" "),a("confirmBoxCom",{directives:[{name:"show",rawName:"v-show",value:e.isShowWarnBox,expression:"isShowWarnBox"}],attrs:{title:"提示",content:"确定驳回？"},on:{confirmAction:e.onReject,cancelAction:function(){return t.isShowWarnBox=!1}}}),e._v(" "),a("confirmBoxCom",{directives:[{name:"show",rawName:"v-show",value:e.isShowRevokeConfirmBox,expression:"isShowRevokeConfirmBox"}],attrs:{title:"提示",content:"确定撤销？"},on:{confirmAction:e.onRevokeConfirm,cancelAction:function(t){e.isShowRevokeConfirmBox=!1}}}),e._v(" "),a("MemberSelect",{ref:"vMemberSelect"})],1)},[],!1,null,"5d297acd",null));e.default=S.exports},ZLHK:function(t,e,o){var a=o("wLqH");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("3a010ea8",a,!0,{})},ZqHM:function(t,e,o){"use strict";o.r(e);var a={name:"approval",props:["bus"],data:function(){return{isTabListShow:!0,currIndex:0,isCom:"approvalIndex",tabList:[{content:"新申请",iconClass:"iconfont-approval",iconDefault:"&#xe6d1;",iconActive:"&#xe602;",com:"approvalIndex"},{content:"我审批的",iconClass:"iconfont-approval",iconDefault:"&#xe606;",iconActive:"&#xe605;",com:"approvalCom"},{content:"我提交的",iconClass:"iconfont-approval",iconDefault:"&#xe609;",iconActive:"&#xe607;",com:"commitCom"},{content:"抄送我的",iconClass:"iconfont-approval",iconDefault:"&#xe676;",iconActive:"&#xe627;",com:"sendCom"}]}},created:function(){this.showHandle(this.$route,{})},watch:{$route:function(t,e){this.showHandle(t,e)}},methods:{tabAction:function(t,e){console.log(111),this.currIndex=e,this.isCom=t.com,this.$router.replace({name:t.com})},showHandle:function(t,e){e.name&&(this.transitionName="fade");var o=this.$route.name;"approvalIndex"===o||"approvalCom"===o||"commitCom"===o||"sendCom"===o?(this.isTabListShow=!0,this.currIndex="approvalIndex"===o?0:"approvalCom"===o?1:"commitCom"===o?2:"sendCom"===o?3:0,this.isCom=o):this.isTabListShow=!1}},components:{App:o("f+TK").a}},i=(o("K1Ne"),o("hghu")),n=Object(i.a)(a,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"approval-container"},[e("div",{staticClass:"cbg"}),this._v(" "),e("App",{staticClass:"cmain",attrs:{bus:this.bus}}),this._v(" "),e("oa-tabBottom",{directives:[{name:"show",rawName:"v-show",value:this.isTabListShow,expression:"isTabListShow"}],attrs:{list:this.tabList,attr:"content",currIndex:this.currIndex},on:{action:this.tabAction}})],1)},[],!1,null,"5c34f5f6",null);e.default=n.exports},Zvd1:function(t,e,o){"use strict";var a=o("WISY");o.n(a).a},aYng:function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,".waichu[data-v-af9ea93c]{padding-top:.12rem;padding-bottom:.36rem}.bottomList[data-v-af9ea93c]{color:#007aff}",""])},bWgQ:function(t,e,o){var a=o("8A7h");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("11a5e62e",a,!0,{})},cwWM:function(t,e,o){"use strict";o.r(e);var a=o("Asgo"),i=o.n(a),n=o("8CNX"),r=o("lKpO"),s=o("p/l8"),c=o("TR4X"),l=o("KqdF"),m=o("cTMg"),d=o("hHQW"),p=o("8ffV"),u=o("kV9B"),f=o("p2D2"),h=o("xVKS"),v={components:{CommitBtnCom:n.a,ApprovalProcessCom:m.a,MemberSelectLevels:f.a,SlideSelectDate:c.a,BottomOptions:h.a,MemberSelect:s.a,ccPersonCom:u.a,TextareaCom:l.a,Cell:d.a,FormCom:p.a},data:function(){return{selectedData:{memberList:[],deptList:[],memberListSubmit:[]},canChangeProcess:!0,canChangeCcpeople:!0,isCommited:!1,bottomOptionsShow:!1,formSectionBoxList:[],curUserId:"",userInfo:{},isShowconfirmBox:!1,formIndexActive:0,formPartActive:"A",SlideSelectDateShow:!1,dateText:"",formArr:[{dateTextA:"",sectionTextA:"",sectionArrIndexA:"",curSectionIdA:"",sectionArrA:[],teacherName:"",teacherId:"",dateTextB:"",sectionArrIndexB:"",sectionTextB:"",curSectionIdB:"",sectionArrB:[]}],approvalPersonArr:[],ccPersonArr:[],textareaText:""}},created:function(){this.getCurrUserInfo(),this.$route.params.id&&"0"!==this.$route.params.id?this.initData():this.getConf()},methods:{getConf:function(){var t=this;console.log("获取--请假审批模板"),r.a.call(this,"/mobicampus/course/v1/getMatchedApproveConf/course_exchange_tk").then(function(e){t.canChangeProcess=e.canChangeProcess,t.approvalPersonArr=e.approvalPersonArr,t.canChangeCcpeople=e.canChangeCcpeople,t.ccPersonArr=e.ccPersonArr,t.selectedData.memberList=t.ccPersonArr})},onMemberAction:function(t){this.$refs.vMemberSelect.show({onConfirm:function(e){0!==e.memberList.length&&(t.user_name=e.memberList[0].user_name,t.user_id=e.memberList[0].user_id)}})},onSelectDirector:function(t){this.$refs.vMemberSelect.show({staticData:t.leader_list,onConfirm:function(e){0!==e.memberList.length&&(t.user_name=e.memberList[0].user_name,t.user_id=e.memberList[0].user_id)}})},selectDateAction:function(t,e){this.SlideSelectDateShow=!0,this.formIndexActive=t,this.formPartActive=e},dateConfirm:function(t){var e=this;"A"===this.formPartActive?(this.formArr[this.formIndexActive].dateTextA=t,this.getCurriculum(t,this.curUserId).then(function(t){e.formArr[e.formIndexActive].sectionArrA=t})):(this.formArr[this.formIndexActive].dateTextB=t,this.formArr[this.formIndexActive].teacherName&&this.formArr[this.formIndexActive].dateTextB&&this.getCurriculum(t,this.formArr[this.formIndexActive].teacherId).then(function(t){e.formArr[e.formIndexActive].sectionArrB=t,e.initformSectionBoxList(t)}))},initformSectionBoxList:function(t){var e=this;this.formSectionBoxList=[],t.map(function(t){e.formSectionBoxList.push(t)})},bottomListAction:function(t,e){"A"===this.formPartActive?(this.formArr[this.formIndexActive].sectionTextA=t.lesson_id_string+" "+t.subject_name,this.formArr[this.formIndexActive].sectionArrIndexA=e,this.formArr[this.formIndexActive].curSectionIdA=t.id):(this.formArr[this.formIndexActive].sectionTextB=t.lesson_id_string+" "+t.subject_name,this.formArr[this.formIndexActive].sectionArrIndexB=e,this.formArr[this.formIndexActive].curSectionIdB=t.id),this.bottomOptionsShow=!1},selectSectionAction:function(t,e,o){var a=this;if(this.formIndexActive=t,this.formPartActive=e,"A"===e){if(!o.dateTextA)return;0===o.sectionArrA.length&&this.getCurriculum(o.dateTextA,this.curUserId).then(function(t){o.sectionArrA=t,a.formSectionBoxList=o.sectionArrA}),this.formSectionBoxList=o.sectionArrA}else{if(!o.dateTextB||!o.teacherName)return;0===o.sectionArrB.length&&this.getCurriculum(o.dateTextB,o.teacherId).then(function(t){o.sectionArrB=t,a.formSectionBoxList=o.sectionArrB}),this.formSectionBoxList=o.sectionArrB}this.bottomOptionsShow=!0},onSectionSelect:function(){},onMemberSelectA:function(t){var e=this;this.$refs.vMemberSelect.show({selectedData:{},onConfirm:function(t){0!==t.memberList.length&&(e.formArr[e.formIndexActive].teacherId=t.memberList[0].user_id,e.formArr[e.formIndexActive].teacherName=t.memberList[0].user_name,e.formArr[e.formIndexActive].teacherName&&e.formArr[e.formIndexActive].dateText&&e.getCurriculum(e.formArr[e.formIndexActive].dateText,e.formArr[e.formIndexActive].teacherId).then(function(t){e.formArr[e.formIndexActive].sectionArr=t,e.initformSectionBoxList(t)}))}})},delPopupAcion:function(t){this.formIndexActive=t,this.isShowconfirmBox=!0},onDelConfirm:function(){this.formArr.splice(this.formIndexActive,1),this.isShowconfirmBox=!1},addFormAction:function(){this.formArr.push({dateTextA:"",sectionTextA:"",sectionArrA:[],teacherName:"",dateTextB:"",sectionTextB:"",sectionArrB:[]})},onMemberSelect:function(){var t=this;this.$refs.vMemberSelect.show({type:"single",onConfirm:function(e){var o=t.approvalPersonArr.length;if(o&&t.approvalPersonArr[o-1].user_id===e.memberList[0].user_id)return t.$simpleMsg("该成员与上级重复"),t.member=!0,!1;t.approvalPersonArr.push(e.memberList[0])}})},onMemberSelectB:function(t){var e=this;this.$refs.vMemberSelect.show({type:"multiple",selectedData:this.selectedData,onConfirm:function(t){e.selectedData=t,e.ccPersonArr=t.memberListSubmit}})},commitBtnAction:function(){if(!this.isCommited){for(var t=[],e=0;e<this.formArr.length;e++){var o=this.formArr[e],a=o.dateTextA,i=o.sectionTextA,n=o.curSectionIdA,r=o.curSectionIdB,s=o.teacherName,c=o.dateTextB,l=o.sectionTextB,m=o.sectionArrA,d=o.sectionArrB,p=o.sectionArrIndexA,u=o.sectionArrIndexB;if(!a)return this.$simpleMsg("请选择表单"+(e+1)+"日期"),this.isCommited=!1,!1;if(!i)return this.$simpleMsg("请选择表单"+(e+1)+"节次"),this.isCommited=!1,!1;if(!s)return this.$simpleMsg("请选择表单"+(e+1)+"调课老师"),this.isCommited=!1,!1;if(!c)return this.$simpleMsg("请选择表单"+(e+1)+"日期"),this.isCommited=!1,!1;if(!l)return this.$simpleMsg("请选择表单"+(e+1)+"节次"),this.isCommited=!1,!1;if(!this.textareaText)return this.$simpleMsg("请填写顶课事由"),!1;if(0===this.approvalPersonArr.length)return this.$simpleMsg("请选择审批人"),!1;var f={from_date:a,from_curriculum_id:n,from_day_in_week:m[p].day_in_week,from_lesson_id:m[p].lesson_id,from_subject_id:m[p].subject_id,from_subject_name:m[p].subject_name,to_date:c,to_user_id:d[u].user_id,to_user_name:d[u].user_name,to_curriculum_id:r,to_day_in_week:d[u].day_in_week,to_lesson_id:d[u].lesson_id,to_subject_id:d[u].subject_id,to_subject_name:d[u].subject_name};t.push(f)}var h={course_exchange:{type:1,reason:this.textareaText,details_list:t},node_list:this.approvalPersonArr,cc_people:this.ccPersonArr};this.isCommited=!0,this.postCreateApplication(h)}},postCreateApplication:function(t){var e=this;this.$preloaderFull.show(),this.$axios.post("/mobicampus/course/v1/createApplication",t).then(function(t){var o=t.data;e.$preloaderFull.close(),200===o.status?e.$router.replace({name:"commitCom"}):e.isCommited=!1}).catch(function(t){console.log("error",t)})},getCurrUserInfo:function(){var t=this;return this.$axios.get("/schoolorg/v1/getCurrUserInfo").then(function(e){var o=e.data,a=o.result.data;200===o.status&&(t.curUserId=a.user_id,t.userInfo=a)}).catch(function(t){console.log(t)})},getCurriculum:function(t,e){var o=this,a=t,n=e;return new i.a(function(t,e){o.$axios.get("/mobicampus/course/v1/getCurriculum/?date="+a+"&user_id="+n).then(function(e){var o=e.data,a=o.result.data;if(200===o.status){var i=[];a.map(function(t){i.push(t)}),t(i)}}).catch(function(t){console.log(t)})})},initData:function(){var t=this;this.$axios.get("/mobicampus/approve/v1/getApplicationDetails/"+this.$route.params.id).then(function(e){var o=e.data,a=o.result.data;if(200===o.status){var i=a.resource,n=a.process,r=a.application;t.formArr=[],t.curUserId=r.create_user_id,i.details_list.map(function(e){var o={dateTextA:e.from_date.split("+")[0].split("T")[0],sectionTextA:e.from_lesson_id_string+" "+e.from_subject_name,curSectionIdA:e.from_curriculum_id,sectionArrIndexA:0,sectionArrA:[{user_id:e.from_user_id,user_name:e.from_user_name,id:e.from_curriculum_id,day_in_week:e.from_day_in_week,lesson_id:e.from_lesson_id,subject_id:e.from_subject_id,subject_name:e.from_subject_name}],teacherName:e.to_user_name,dateTextB:e.to_date.split("+")[0].split("T")[0],sectionTextB:e.to_lesson_id_string+" "+e.to_subject_name,curSectionIdB:e.to_curriculum_id,sectionArrIndexB:0,sectionArrB:[{user_id:e.to_user_id,user_name:e.to_user_name,id:e.to_curriculum_id,day_in_week:e.to_day_in_week,lesson_id:e.to_lesson_id,subject_id:e.to_subject_id,subject_name:e.to_subject_name}]};t.formArr.push(o)}),t.textareaText=i.reason,n.node_list.map(function(e,o){var a={user_name:e.user_name,user_id:e.user_id};0===o&&parseInt(e.user_id)===parseInt(t.curUserId)||t.approvalPersonArr.push(a)}),a.cc_people.map(function(e){var o={user_name:e.user_name,user_id:e.user_id};t.ccPersonArr.push(o)})}}).catch(function(t){console.log("error",t)})}}},b=(o("9/Se"),o("hghu")),x=Object(b.a)(v,function(){var t=this,e=this,o=e.$createElement,a=e._self._c||o;return a("div",{staticClass:"tiaoke  page-bg"},[e._l(e.formArr,function(t,o){return a("div",{key:o,staticClass:"form-box",on:{click:function(t){e.formIndexActive=o}}},[a("FormCom",[a("cell",{attrs:{button:"",title:"日期",content:t.dateTextA},on:{action:function(a){e.selectDateAction(o,"A",t)}}}),e._v(" "),a("cell",{attrs:{button:"",title:"节次",content:t.sectionTextA},on:{action:function(a){e.selectSectionAction(o,"A",t)}}})],1),e._v(" "),e._m(0,!0),e._v(" "),a("FormCom",[a("cell",{attrs:{button:"",title:"老师",content:t.teacherName},on:{action:e.onMemberSelectA}}),e._v(" "),a("cell",{attrs:{button:"",title:"日期",content:t.dateTextB},on:{action:function(a){e.selectDateAction(o,"B",t)}}}),e._v(" "),a("cell",{attrs:{button:"",title:"节次",content:t.sectionTextB},on:{action:function(a){e.selectSectionAction(o,"B",t)}}})],1),e._v(" "),a("div",{staticClass:"addAndDel-box"},[a("div",{directives:[{name:"show",rawName:"v-show",value:o===e.formArr.length-1,expression:"index === formArr.length - 1"}],staticClass:"addBtn"},[a("span",{staticClass:"iconfont-approval"},[e._v("")]),e._v(" "),a("span",{staticClass:"text",on:{click:e.addFormAction}},[e._v("添加")])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1!==e.formArr.length,expression:"formArr.length !== 1"}],staticClass:"delBtn",on:{click:e.delPopupAcion}},[a("span",{staticClass:"iconfont-approval"},[e._v("")]),e._v(" "),a("span",{staticClass:"text",on:{click:function(t){e.delPopupAcion(o)}}},[e._v("删除")])])])],1)}),e._v(" "),a("TextareaCom",{attrs:{placeholder:"请输入调课事由",content:e.textareaText},on:{"update:content":function(t){e.textareaText=t}}}),e._v(" "),a("ApprovalProcessCom",{attrs:{needDelBtn:e.canChangeProcess,needAddBtn:e.canChangeProcess,needArrow:!0,approvalPersonArr:e.approvalPersonArr},on:{addPerson:e.onMemberSelect,selectDirector:e.onSelectDirector,memberAction:e.onMemberAction}}),e._v(" "),a("ccPersonCom",{attrs:{ccPersonArr:e.ccPersonArr},on:{addPerson:e.onMemberSelectB}}),e._v(" "),a("CommitBtnCom",{on:{action:e.commitBtnAction}}),e._v(" "),a("MemberSelect",{ref:"vMemberSelect"}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowconfirmBox,expression:"isShowconfirmBox"}],staticClass:"mask-box"}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowconfirmBox,expression:"isShowconfirmBox"}],staticClass:"warn-box"},[a("div",{staticClass:"title"},[e._v("提示")]),e._v(" "),a("div",{staticClass:"content"},[e._v("确定删除？")]),e._v(" "),a("div",{staticClass:"btn-box"},[a("div",{staticClass:"confirmBtn",on:{click:function(){return t.isShowconfirmBox=!1}}},[e._v("取消")]),e._v(" "),a("div",{staticClass:"confirmBtn",on:{click:e.onDelConfirm}},[e._v("确定")])])]),e._v(" "),a("SlideSelectDate",{attrs:{show:e.SlideSelectDateShow,value:e.dateText},on:{curPageConfirm:e.dateConfirm,"update:show":function(t){e.SlideSelectDateShow=t},"update:value":function(t){e.dateText=t},error:function(t){e.timeError("发生未知错误")}}}),e._v(" "),a("BottomOptions",{attrs:{show:e.bottomOptionsShow},on:{select:e.onSectionSelect,"update:show":function(t){e.bottomOptionsShow=t}}},[a("ul",e._l(e.formSectionBoxList,function(t,o){return a("li",{key:o+"33",attrs:{"data-type":o},on:{click:function(a){e.bottomListAction(t,o)}}},[e._v(e._s(t.lesson_id_string+" "+t.subject_name))])}))])],2)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"changeBtn-box"},[e("span",{staticClass:"iconfont-approval"},[this._v("")])])}],!1,null,"f9c71966",null);e.default=x.exports},dbf6:function(t,e,o){var a=o("m+L2");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("0d1299a8",a,!0,{})},e5ns:function(t,e,o){"use strict";var a=o("RGpD");o.n(a).a},"eOM/":function(t,e,o){"use strict";var a=o("hjkR");o.n(a).a},gKfL:function(t,e,o){var a=o("8Who");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("1b052e1a",a,!0,{})},gSaW:function(t,e,o){"use strict";var a=o("h0FV");o.n(a).a},h0FV:function(t,e,o){var a=o("xPVP");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("a82ac420",a,!0,{})},hL0j:function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,".row[data-v-0aa36ee5]{display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:.3rem;font-size:.13rem}.l[data-v-0aa36ee5]{width:.75rem;color:#999}.r[data-v-0aa36ee5]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;color:#666;word-break:break-all}.form[data-v-0aa36ee5]{margin-top:.12rem;background:#efefef}.head[data-v-0aa36ee5]{color:#666;padding:.05rem 0}",""])},hjkR:function(t,e,o){var a=o("J8TP");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("1ef8413a",a,!0,{})},itbW:function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,"",""])},jAdf:function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,'.approval[data-v-1b0b5932]{padding-bottom:.64rem}.approval .tabList[data-v-1b0b5932]{background-color:#fff;display:-webkit-flex;display:-ms-flexbox;display:flex;position:fixed;bottom:0;left:0;width:100%;height:.54rem;padding:.06rem 0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 -.03rem .08rem #b9c3cf;box-shadow:0 -.03rem .08rem #b9c3cf}.approval .tabList>li[data-v-1b0b5932]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;text-align:center;color:#3d72a4}.approval .tabList>li>span[data-v-1b0b5932]{width:100%;display:inline-block;font-size:.12rem}.approval .tabList>li span.iconfont-approval[data-v-1b0b5932]{font-size:.23rem}.icon-apply[data-v-1b0b5932]:before{content:"\\E6D1"}.icon-approval[data-v-1b0b5932]:before{content:"\\E606"}.icon-submit[data-v-1b0b5932]:before{content:"\\E609"}.icon-send[data-v-1b0b5932]:before{content:"\\E676"}li.active .icon-apply[data-v-1b0b5932]:before{content:"\\E602"}li.active .icon-approval[data-v-1b0b5932]:before{content:"\\E605"}li.active .icon-submit[data-v-1b0b5932]:before{content:"\\E607"}li.active .icon-send[data-v-1b0b5932]:before{content:"\\E627"}',""])},kKDE:function(t,e,o){var a=o("IFRh");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("038ffcf5",a,!0,{})},lKpO:function(t,e,o){"use strict";o.d(e,"b",function(){return s}),o.d(e,"a",function(){return c});var a=o("unDg"),i=o.n(a),n=o("Asgo"),r=o.n(n);function s(t){var e=this;return new r.a(function(o,a){e.$axios.get("/mobicampus/"+t+"/v1/getInitInfo").then(function(e){var a=e.data;if(200===a.status){var i=t+"_type_list",n=[];a.result.data[i].map(function(t){var e={name:t.name,type:t.type};n.push(e)}),o(n)}}).catch(function(t){a(t)})})}function c(t){return this.$axios.get(t).then(function(t){var e=t.data;if(200===e.status){var o=e.result.data.approve_conf_com,a={need_approve:o.approve_conf.need_approve,can_change_process:o.approve_conf.can_change_process,need_cc:o.approve_conf.need_cc,can_change_ccpeople:o.approve_conf.can_change_ccpeople,process_template_node_list:o.process_template_node_list,cc_people:o.cc_people};return console.log("审批设置模板",a),a}}).then(function(t){var e=void 0,o=void 0,a=void 0,n=void 0;return"true"===t.need_approve&&(e="true"===t.can_change_process,o=t.process_template_node_list.map(function(t){return 1===t.leader_list.length&&(t.user_name=t.leader_list[0].user_name,t.user_id=t.leader_list[0].user_id),{user_name:t.user_name,user_id:parseInt(t.user_id),type:t.type,leader_list:t.leader_list}})),"true"===t.need_cc&&(a="true"===t.can_change_ccpeople,n=[],t.cc_people.forEach(function(t){var e;"2"===t.type?n.push({user_id:t.user_id,user_name:t.user_name}):(e=n).push.apply(e,i()(t.leader_list))})),{canChangeProcess:e,approvalPersonArr:o,canChangeCcpeople:a,ccPersonArr:n}}).catch(function(){return{canChangeProcess:!0,approvalPersonArr:[],canChangeCcpeople:!0,ccPersonArr:[]}})}},"m+L2":function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,"button[data-v-0bd32eae]{min-width:.3rem;height:.2rem}.aaa[data-v-0bd32eae]{width:1rem;height:1rem;background:#ccc}.box[data-v-0bd32eae]{overflow:hidden;margin:10%;height:3rem;border:1px solid #ccc}",""])},ndJD:function(t,e,o){"use strict";var a=o("Lxdk");o.n(a).a},ntpU:function(t,e,o){"use strict";o.r(e);var a=o("hHQW"),i=o("8ffV"),n={props:{show:{type:Boolean,default:!0},title:{type:String,default:"提示"},content:{type:String,default:"确定执行?"},confirmButtonText:{type:String,default:"确定"},cancelButtonText:{type:String,default:"取消"}}},r=(o("JCDb"),o("hghu")),s=Object(r.a)(n,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("transition",{attrs:{name:"zoom"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}]},[o("div",{staticClass:"mask-box"}),t._v(" "),o("div",{staticClass:"warn-box"},[o("div",{staticClass:"content"},[t._v(t._s(t.content))]),t._v(" "),o("div",{staticClass:"btn-box top-one-px"},[o("div",{staticClass:"btn confirm",on:{click:function(){t.$emit("cancelAction"),t.$emit("updata:show",!1)}}},[t._v(t._s(t.cancelButtonText))]),t._v(" "),o("div",{staticClass:"btn",on:{click:function(){t.$emit("confirmAction"),t.$emit("updata:show",!1)}}},[t._v(t._s(t.confirmButtonText))])])])])])},[],!1,null,"1f100911",null).exports,c={props:["list"]},l=(o("eOM/"),{components:{demo:Object(r.a)(c,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("ul",t._l(t.list,function(e,a){return o("li",{key:a,class:{active:e.isSelect},on:{click:function(o){t.$emit("action",e,a)}}},[t._v(t._s(e.content))])}))},[],!1,null,"7e963d4a",null).exports,Cell:a.a,FormCom:i.a,confirmBoxCom:s},data:function(){return{i:0,show:!1,dateSelA:"",dateSelB:"",time:"",list:[],list2:{a:{b:{c:[]}}}}},computed:{d:function(){return this.list2.a.b.c}},beforeCreate:function(){},created:function(){for(var t=0;t<10;t++)this.list.push(this.getList(t))},beforeMount:function(){},mounted:function(){},watch:{list2:function(){console.log("watch")}},methods:{aaa:function(t,e){t.isSelect=!t.isSelect},bbb:function(){this.list2.a.b.c=this.getList()},getList:function(t){for(var e=[],o=0;o<10;o++)e.push({content:t+""+o,isSelect:!1});return e}}}),m=(o("MWlb"),Object(r.a)(l,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"box"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.i,expression:"i"}],attrs:{type:"text"},domProps:{value:t.i},on:{input:function(e){e.target.composing||(t.i=e.target.value)}}}),t._v(" "),o("button",{on:{click:t.bbb}},[t._v("按钮")]),t._v(" "),o("demo",{ref:"selectTime",attrs:{list:t.d},on:{action:t.aaa}})],1)},[],!1,null,"0bd32eae",null));e.default=m.exports},oQCK:function(t,e,o){"use strict";var a=o("yuGO");o.n(a).a},osab:function(t,e,o){"use strict";o.r(e);var a=o("omC7"),i=o.n(a),n=o("lKpO"),r={data:function(){return{size:10,inputV:"",timer:null,statusArr:["待审批","","已通过","未通过","已撤销","已转交"],leaveTypeList:[],biztripTypeList:[],dataArr:[],showBg:!1}},computed:{begin:function(){return this.dataArr.length}},created:function(){var t=this;n.b.call(this,"leave").then(function(e){t.leaveTypeList=e}),n.b.call(this,"biztrip").then(function(e){t.biztripTypeList=e})},components:{LoaderRefresh:o("74OJ").a},methods:{loadData:function(t){var e=this,o=t.type,a=t.complete,i=t.vLoaderBottom;"refresh"===o?this.getDataList(0,this.size).then(function(t){e.dataArr=t||[],e.$nextTick(function(){i.reset(),i.tryLoad()}),a()}):this.getDataList(this.begin,this.size).then(function(t){var o=(t=t||[]).length;e.dataArr=e.dataArr.concat(t),e.$nextTick(function(){i.$el.offsetTop+90<window.innerHeight&&i.hide(),a(0===o)})})},itemAction:function(t){this.$router.push({name:"approvalDetail",params:{id:t,type:"0"}})},searchAction:function(){var t=this;clearTimeout(this.timer),setTimeout(function(){t.dataArr.map(function(e,o){-1===i()(e).indexOf(t.inputV)?e.isNotSearched=!0:e.isNotSearched=!1})},100)},refresh:function(){},getDataList:function(t,e){var o=this;return t=t||0,e=e||10,this.$axios.get("/mobicampus/approve/v1/getApplicationList?list_type=cc&begin="+t+"&size="+e).then(function(e){var a=e.data;if(200===a.status){console.log("if-抄送我",a);var i=[],n=a.result.data.application_list;return o.showBg=0===t&&0===n.length,n.map(function(t){console.log("item",t),console.log("item.resource.create_time",t.resource.create_time);var e={};e.id=t.application.id,e.personName=t.application.create_user_name,e.applicationName=t.application.name;var a=t.resource.create_time.split("+")[0].split("T"),n=(new Date).toDateString(),r=new Date(a[0]).toDateString(),s=a[0].indexOf("-");a[0]=a[0].slice(s+1);var c=a[1].lastIndexOf(":");if(a[1]=a[1].slice(0,c),e.time=n===r?a[1]:a[0]+" "+a[1],"leave"===t.application.module_code){e.event="请假",e.status=o.statusArr[t.application.process_state];var l=t.resource.start_time.split("+")[0].split("T"),m=t.resource.end_time.split("+")[0].split("T"),d=t.resource.duration/8;e.contentArr=[["请假类型",t.resource.type_name],["请假时间",l[0]+"~"+m[0]],["请假时长",d+"天"]]}else if("biztrip"===t.application.module_code){e.event="外出",e.status=o.statusArr[t.application.process_state-1];var p=t.resource.start_time.split("+")[0].split("T"),u=t.resource.end_time.split("+")[0].split("T");e.contentArr=[["外出地点",t.resource.destination],["开始结束",p[0]+"~"+u[0]],["外出事由",t.resource.desc]]}else"course_exchange_tk"===t.application.module_code?(e.event="调课",e.processState=t.application.process_state,e.contentArr=[["调课事由",t.resource.reason]]):"course_exchange_dnk"===t.application.module_code?(e.event="顶课",e.processState=t.application.process_state,e.contentArr=[["顶课事由",t.resource.reason]]):"announce"===t.application.module_code?(e.event="公告",e.statusText=o.statusArr[t.application.state_processed],e.processState=t.application.process_state,e.contentArr=[["公告标题",t.resource.title],["公告类型",t.resource.type_name],["公告内容",t.resource.content]]):"fund"===t.application.module_code?(e.event="经费",e.statusText=o.statusArr[t.application.state_processed],e.processState=t.application.process_state,e.contentArr=[["经费金额",t.resource.amount],["经费类型",t.resource.type_name],["经费事由",t.resource.desc]]):"assets_purchase"===t.application.module_code?(e.event="采购",e.statusText=o.statusArr[t.application.state_processed],e.processState=t.application.process_state,e.contentArr=[["采购事由",t.resource.desc],["采购金额",t.resource.amount]]):"car_using"===t.application.module_code&&(e.event="用车",e.statusText=o.statusArr[t.application.state_processed],e.processState=t.application.process_state,e.contentArr=[["用车人数",t.resource.desc],["用车目的地",t.resource.destination],["用车事由",t.resource.number_of_people+"人"]]);e.isNotSearched=!1,i.push(e)}),i}}).catch(function(t){console.log(t)})}}},s=(o("OZe1"),o("hghu")),c=Object(s.a)(r,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"content-box sendCom"},[o("oa-bg-nodata",{directives:[{name:"show",rawName:"v-show",value:t.showBg,expression:"showBg"}]}),t._v(" "),o("div",{staticClass:"head-bg-box"}),t._v(" "),o("oa-search",{attrs:{position:"",keyword:t.inputV,placeholder:"搜索..."},on:{"update:keyword":function(e){t.inputV=e}}}),t._v(" "),o("LoaderRefresh",{attrs:{colorTop:"black",colorBottom:"black"},on:{loadData:t.loadData}},t._l(t.dataArr,function(e,a){return o("oa-listCom",{key:a,staticClass:"item-box"},[o("div",{staticClass:"itemContent-box",class:{searchActive:e.isNotSearched},on:{click:function(){return t.itemAction(e.id)}}},[o("div",{staticClass:"title-box"},[o("p",{staticClass:"title"},[t._v(t._s(e.applicationName))]),t._v(" "),o("span",{staticClass:"time"},[t._v(t._s(e.time))])]),t._v(" "),t._l(e.contentArr,function(e,a){return o("p",{key:a,staticClass:"itemType"},[o("span",[t._v(t._s(e[0]))]),t._v("\n          ：\n          "),o("span",{staticClass:"contentText"},[t._v(t._s(e[1]))])])})],2)])}))],1)},[],!1,null,"98cec9c4",null);e.default=c.exports},q2n7:function(t,e,o){var a=o("ykn4");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("c4bd8094",a,!0,{})},qkpI:function(t,e,o){"use strict";var a=o("QNfw");o.n(a).a},rEbm:function(t,e,o){"use strict";var a=o("bWgQ");o.n(a).a},s356:function(t,e,o){"use strict";o.r(e);var a=o("omC7"),i=o.n(a),n=o("lKpO"),r={data:function(){return{isHide:!1,size:10,timer:null,inputV:"",statusArr:["待审批","","已通过","未通过","已撤销","已转交"],leaveTypeList:[],biztripTypeList:[],isLoadAdd:!1,tabList:["待审批","已审批"],isTabActive:0,iSallSelectActive:!1,iSallSelected:!1,todoDataArr:[],approvedDataArr:[],showBg:!1}},computed:{beginA:function(){return this.todoDataArr.length},beginB:function(){return this.approvedDataArr.length}},watch:{$route:function(t,e){this.isHide="ApprovalDetail"===t.name}},components:{LoaderRefresh:o("74OJ").a},created:function(){var t=this;n.b.call(this,"leave").then(function(e){t.leaveTypeList=e}),n.b.call(this,"biztrip").then(function(e){t.biztripTypeList=e})},beforeRouteEnter:function(t,e,o){o(function(t){"approvalDetail"===e.name&&(t.isTabActive=1===parseInt(e.params.type)?0:1)})},methods:{loadDataA:function(t){var e=this,o=t.type,a=t.complete,i=t.vLoaderBottom;if("refresh"===o)0===this.isTabActive?this.getDataList("todo",0,this.size).then(function(t){e.todoDataArr=t||[],e.$nextTick(function(){i.reset(),i.tryLoad()}),a()}):this.getDataList("approved",0,this.size).then(function(t){e.approvedDataArr=t||[],e.$nextTick(function(){i.reset(),i.tryLoad()}),a()});else{var n=void 0;0===this.isTabActive?this.getDataList("todo",this.beginA,this.size).then(function(t){n=(t=t||[]).length,e.todoDataArr=e.todoDataArr.concat(t),e.$nextTick(function(){i.$el.offsetTop+90<window.innerHeight&&i.hide(),a(0===n)})}):this.getDataList("approved",this.beginB,this.size).then(function(t){n=(t=t||[]).length,e.approvedDataArr=e.approvedDataArr.concat(t),e.$nextTick(function(){i.$el.offsetTop+90<window.innerHeight?i.hide():i.show(),a(0===n)})})}},tabAction:function(t){this.isTabActive=t,this.iSallSelectActive=!1,this.$refs.LoaderRefresh.$refs.vLoaderBottom.reStart()},allSelectAction:function(){0!==this.todoDataArr.length&&(this.iSallSelectActive=!this.iSallSelectActive)},allSelBoxAction:function(){this.iSallSelected=!this.iSallSelected;for(var t=0;t<this.todoDataArr.length;t++)this.todoDataArr[t].isSelected=this.iSallSelected},singleSelAction:function(t){t.isSelected=!t.isSelected},cancelAction:function(){this.iSallSelectActive=!1,this.iSallSelected=!1,this.todoDataArr.map(function(t){t.isSelected=!1})},sureAction:function(){var t=this;this.iSallSelectActive=!1,this.iSallSelected=!1;var e={process_id_list:[]};this.todoDataArr.map(function(t,o){t.isSelected&&e.process_id_list.push(parseInt(t.processId))}),this.$axios.post("/mobicampus/approve/v1/approvePassBatch",e).then(function(e){200===e.data.status&&t.getDataList("todo").then(function(e){t.todoDataArr=e||[]})})},itemContentAction:function(t,e,o){var a="0";"0"===e?a="1":"1"===o&&(a="4"),this.$router.push({name:"approvalDetail",params:{id:t,type:a}})},searchAction:function(){var t=this;clearTimeout(this.timer),this.timer=setTimeout(function(){(0===t.isTabActive?t.todoDataArr:t.approvedDataArr).map(function(e,o){-1===i()(e).indexOf(t.inputV)?e.isNotSearched=!0:e.isNotSearched=!1})},100)},getDataList:function(t,e,o){var a=this;return e=e||0,o=o||10,this.$axios.get("/mobicampus/approve/v1/getApplicationList?list_type="+t+"&begin="+e+"&size="+o).then(function(t){var o=t.data;if(200===o.status){var i=[],n=o.result.data.application_list;return a.showBg=0===e&&0===n.length,n.map(function(t){var e={};e.processState=t.application.process_state,e.curNodeState=t.application.state_processed,e.statusText=a.statusArr[t.application.state_processed],e.id=t.application.id,e.processId=t.application.process_id,e.personName=t.application.create_user_name,e.applicationName=t.application.name;var o=t.application.create_time;if(e.time=a.$getTimeStr(o,"yy-mm hh:mm",!0),"leave"===t.application.module_code){e.event="请假",e.statusText=a.statusArr[t.application.state_processed],e.processState=t.application.process_state;var n=t.resource.start_time.split("+")[0].split("T"),r=t.resource.end_time.split("+")[0].split("T"),s=t.resource.duration/8;e.contentArr=[["请假类型",t.resource.type_name],["请假时间",n[0]+"~"+r[0]],["请假时长",s+"天"]]}else if("biztrip"===t.application.module_code){e.event="外出",e.processState=t.application.process_state,e.statusText=a.statusArr[t.application.state_processed];var c=t.resource.start_time.split("+")[0].split("T"),l=t.resource.end_time.split("+")[0].split("T");e.contentArr=[["外出地点",t.resource.destination],["开始结束",c[0]+"~"+l[0]],["外出事由",t.resource.desc]]}else if("course_exchange_tk"===t.application.module_code)e.event="调课",e.statusText=a.statusArr[t.application.state_processed],e.processState=t.application.process_state,e.contentArr=[["调课事由",t.resource.reason]];else if("course_exchange_dnk"===t.application.module_code)e.event="顶课",e.processState=t.application.process_state,e.statusText=a.statusArr[t.application.state_processed],e.contentArr=[["顶课事由",t.resource.reason]];else if("announce"===t.application.module_code)e.event="公告",e.statusText=a.statusArr[t.application.state_processed],e.processState=t.application.process_state,e.contentArr=[["公告标题",t.resource.title],["公告类型",t.resource.type_name],["公告内容",t.resource.content]];else if("attend_appeal"===t.application.module_code){e.event="申诉",e.statusText=a.statusArr[t.application.state_processed],e.processState=t.application.process_state,e.contentArr=[["异常日期",t.resource.date_to_clock.split("T")[0]],["异常情况",["","迟到","早退","正常","异常","缺卡"][t.resource.type]],["申诉理由",t.resource.reason]]}else"fund"===t.application.module_code?(e.event="经费",e.statusText=a.statusArr[t.application.state_processed],e.processState=t.application.process_state,e.contentArr=[["经费金额",t.resource.amount],["经费类型",t.resource.type_name],["经费事由",t.resource.desc]]):"assets_purchase"===t.application.module_code?(e.event="采购",e.statusText=a.statusArr[t.application.state_processed],e.processState=t.application.process_state,e.contentArr=[["采购事由",t.resource.desc],["采购金额",t.resource.amount+"元"]]):"car_using"===t.application.module_code&&(e.event="用车",e.statusText=a.statusArr[t.application.state_processed],e.processState=t.application.process_state,e.contentArr=[["用车人数",t.resource.desc],["用车目的地",t.resource.destination],["用车事由",t.resource.number_of_people+"人"]]);e.isSelected=!1,e.isNotSearched=!1,i.push(e)}),i}})}}},s=(o("e5ns"),o("hghu")),c=Object(s.a)(r,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"content-box approvalCom",class:{isHide:t.isHide}},[o("oa-bg-nodata",{directives:[{name:"show",rawName:"v-show",value:t.showBg,expression:"showBg"}]}),t._v(" "),o("oa-tabHead",{attrs:{position:"",list:t.tabList,currIndex:t.isTabActive},on:{action:function(e){return t.tabAction(e)}}},[o("oa-search",{attrs:{keyword:t.inputV,placeholder:"搜索..."},on:{"update:keyword":function(e){t.inputV=e}}},[o("div",{directives:[{name:"show",rawName:"v-show",value:0===t.isTabActive,expression:"isTabActive === 0"}],staticClass:"all-select",class:{active:t.iSallSelectActive},attrs:{slot:"right"},on:{click:t.allSelectAction},slot:"right"},[o("div",{staticClass:"icon-box allSel"},[o("span",{staticClass:"iconfont icon-allSel"})]),t._v(" "),o("div",{staticClass:"words-box"},[o("span",[t._v("批量通过")])])])])],1),t._v(" "),o("LoaderRefresh",{ref:"LoaderRefresh",attrs:{colorTop:"black",colorBottom:"black"},on:{loadData:t.loadDataA}},[t._l(t.todoDataArr,function(e,a){return o("oa-listCom",{directives:[{name:"show",rawName:"v-show",value:0===t.isTabActive,expression:"isTabActive === 0"}],key:a+"2",staticClass:"item-box",class:{searchActive:e.isNotSearched}},[o("div",{staticClass:"singleSel-box",class:{active:e.isSelected},on:{click:function(){return t.singleSelAction(e)}}},[o("span",{directives:[{name:"show",rawName:"v-show",value:e.isSelected,expression:"item.isSelected"}],staticClass:"iconfont-approval"},[t._v("")])]),t._v(" "),o("div",{staticClass:"itemContent-box",class:{active:t.iSallSelectActive},on:{click:function(){return t.itemContentAction(e.id,e.curNodeState,e.processState)}}},[o("div",{staticClass:"title-box clearfix"},[o("p",{staticClass:"title"},[t._v(t._s(e.applicationName))]),t._v(" "),o("span",{staticClass:"time"},[t._v(t._s(e.time))])]),t._v(" "),t._l(e.contentArr,function(e,a){return o("p",{key:a,staticClass:"itemType"},[o("span",[t._v(t._s(e[0]))]),t._v("\n          ：\n          "),o("span",{staticClass:"contentText"},[t._v(t._s(e[1]))])])})],2)])}),t._v(" "),t._l(t.approvedDataArr,function(e,a){return"4"!==e.curNodeState?o("oa-listCom",{directives:[{name:"show",rawName:"v-show",value:1===t.isTabActive,expression:"isTabActive === 1"}],key:a+"3",staticClass:"item-box",class:{searchActive:e.isNotSearched}},[o("div",{staticClass:"itemContent-box",on:{click:function(){return t.itemContentAction(e.id,e.curNodeState,e.processState)}}},[o("div",{staticClass:"title-box clearfix"},[o("p",{staticClass:"title"},[t._v(t._s(e.applicationName))]),t._v(" "),o("span",{staticClass:"status",class:{filtelActive:"4"===e.curNodeState,"bg-blue":"5"===e.curNodeState,"bg-red":"3"===e.curNodeState,"bg-green":"2"===e.curNodeState}},[t._v(t._s(e.statusText))]),t._v(" "),o("span",{staticClass:"time"},[t._v(t._s(e.time))])]),t._v(" "),t._l(e.contentArr,function(e,a){return o("p",{key:a+"4",staticClass:"itemType"},[o("span",[t._v(t._s(e[0]))]),t._v("\n          ：\n          "),o("span",{staticClass:"contentText"},[t._v(t._s(e[1]))])])})],2)]):t._e()})],2),t._v(" "),o("div",{staticClass:"bottom-allSel-box",class:{active:t.iSallSelectActive}},[o("div",{staticClass:"btn-cancel"},[o("div",{staticClass:"cancel-left",on:{click:t.allSelBoxAction}},[o("div",{staticClass:"singleSel-box",class:{active:t.iSallSelected}},[o("span",{directives:[{name:"show",rawName:"v-show",value:t.iSallSelected,expression:"iSallSelected"}],staticClass:"iconfont-approval"},[t._v("")])])]),t._v(" "),o("div",{staticClass:"cancel-right",on:{click:t.cancelAction}},[o("span",{staticClass:"cancelText"},[t._v("取消")])])]),t._v(" "),o("div",{staticClass:"btn-sure",on:{click:t.sureAction}},[t._v("一键通过")])])],1)},[],!1,null,"127ec07c",null);e.default=c.exports},s5PD:function(t,e,o){var a=o("iTuz");(t.exports=o("lbwJ")(!1)).push([t.i,"@font-face{font-family:iconfont-approval;src:url("+a(o("RQol"))+') format("truetype")}.approval-container[data-v-5c34f5f6] .iconfont-approval{font-family:iconfont-approval;font-size:.16rem;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.cbg[data-v-5c34f5f6]{z-index:-1;position:fixed;top:0;bottom:0;left:0;right:0;background-color:#fff}.cmain[data-v-5c34f5f6]{position:relative}',""])},tuFf:function(t,e,o){"use strict";var a=o("+azj");o.n(a).a},u7qo:function(t,e,o){"use strict";o.r(e);var a=o("8CNX"),i=o("lKpO"),n=o("p/l8"),r=o("ydf2"),s=o("cTMg"),c=o("hHQW"),l=o("8ffV"),m=o("KqdF"),d=o("kV9B"),p=o("6UnF"),u=o("xVKS"),f=o("k0ul"),h={components:{CommitBtnCom:a.a,TextareaCom:m.a,ApprovalProcessCom:s.a,AttachmentCom:p.a,SlideSelectDate:r.a,BottomOptions:u.a,MemberSelect:n.a,ccPersonCom:d.a,FormCom:l.a,Cell:c.a},data:function(){return{budget:"",gotogetherUserList:[],selectedDataB:{memberList:[],deptList:[],memberListSubmit:[]},selectedData:{memberList:[],deptList:[],memberListSubmit:[]},canChangeProcess:!0,canChangeCcpeople:!0,isCommited:!1,userInfo:{},curUserId:"",memberSelectType:"single",memberSelectSelected:null,member:0,memberSelectTypeB:"multiple",memberSelectSelectedB:[],memberB:0,SlideSelectDateShowA:!1,SlideSelectDateShowB:!1,bottomOptionsShow:!1,bottomOptionsShowB:!1,dateSelA:"",dateSelB:"",site:"",textareaText:"",approvalPersonArr:[],ccPersonArr:[],imgList:[],fileList:[],attachmentList:[],biztripTypeList:[],typeId:"",typeName:""}},watch:{},created:function(){var t=this;this.getCurrUserInfo(),this.getBiztripType().then(function(e){t.biztripTypeList=e,t.$route.params.id&&"0"!==t.$route.params.id&&t.getApplicationDetails()})},methods:{getConf:function(){var t=this;console.log("获取--请假审批模板"),i.a.call(this,"/mobicampus/biztrip/v1/getMatchedApproveConf/"+this.typeId).then(function(e){t.canChangeProcess=e.canChangeProcess,t.approvalPersonArr=e.approvalPersonArr,t.canChangeCcpeople=e.canChangeCcpeople,t.ccPersonArr=e.ccPersonArr,t.selectedData.memberList=t.ccPersonArr})},onMemberAction:function(t){this.$refs.vMemberSelect.show({onConfirm:function(e){0!==e.memberList.length&&(t.user_name=e.memberList[0].user_name,t.user_id=e.memberList[0].user_id)}})},onSelectDirector:function(t){console.log("选择主管",t),this.$refs.vMemberSelect.show({staticData:t.leader_list,onConfirm:function(e){0!==e.memberList.length&&(t.user_name=e.memberList[0].user_name,t.user_id=e.memberList[0].user_id)}})},getCurrUserInfo:function(){var t=this;return this.$axios.get("/schoolorg/v1/getCurrUserInfo").then(function(e){var o=e.data;if(200===o.status){var a=o.result.data;t.userInfo=a}})},timeError:function(t){this.$simpleMsg(t)},biztripTypeAction:function(t){this.typeId=t.id,this.typeName=t.name,this.bottomOptionsShow=!1,this.getConf()},addPersonAction:function(){this.member=1},onMemberSelect:function(){var t=this;this.$refs.vMemberSelect.show({type:"single",onConfirm:function(e){if(console.log("selectedData",e),0!==e.memberList.length){var o=t.approvalPersonArr.length;if(o&&t.approvalPersonArr[o-1].user_id===e.memberList[0].user_id)return t.$simpleMsg("该成员与上级重复"),t.member=!0,!1;t.approvalPersonArr.push(e.memberList[0])}}})},onMemberSelectC:function(t){var e=this;console.log("this.selectedData",this.selectedData),this.$refs.vMemberSelect.show({type:"multiple",selectedData:this.selectedDataB,onConfirm:function(t){e.selectedDataB=t,e.gotogetherUserList=t.memberListSubmit}})},onMemberSelectB:function(t){var e=this;console.log("this.selectedData",this.selectedData),this.$refs.vMemberSelect.show({type:"multiple",selectedData:this.selectedData,onConfirm:function(t){e.selectedData=t,e.ccPersonArr=t.memberListSubmit}})},commitBtnAction:function(){var t=this;if(this.isCommited)return 0;this.isCommited=!0;var e=this.typeName,o=this.dateSelA,a=this.dateSelB,i=this.textareaText,n=this.approvalPersonArr;return e?o?a?i?n.length?void(0!==this.imgList.length?Object(f.a)(this.imgList).then(function(e){0!==e.length?(t.attachmentList=e,t.postCreateApplication()):(t.$simpleMsg("图片上传失败，请重新提交"),t.isCommited=!1)}):this.postCreateApplication()):(this.$simpleMsg("请选择审批人"),this.isCommited=!1,!1):(this.$simpleMsg("请输入外出理由"),this.isCommited=!1,!1):(this.$simpleMsg("请选择结束时间"),this.isCommited=!1,!1):(this.$simpleMsg("请选择开始时间"),this.isCommited=!1,!1):(this.$simpleMsg("请选择外出类型"),this.isCommited=!1,!1)},postCreateApplication:function(){var t=this;this.isCommited=!0;var e=this.typeId,o=this.typeName,a=this.dateSelA,i=this.dateSelB,n=this.site,r=this.budget,s=this.textareaText,c={biztrip:{type_name:o,type_id:e,start_time:a.split("  ")[0]+"  "+("上午"===a.split("  ")[1]?"07:50:00":"14:00:00"),end_time:i.split("  ")[0]+"  "+("上午"===i.split("  ")[1]?"12:00:00":"17:00:00"),destination:n,desc:s,budget:r||0,attachment_list:this.attachmentList},gotogether_user_list:this.gotogetherUserList,node_list:this.approvalPersonArr,cc_people:this.ccPersonArr};this.$preloaderFull.show(),this.$axios.post("/mobicampus/biztrip/v1/createApplication",c).then(function(e){var o=e.data;t.$preloaderFull.close(),200===o.status?t.$router.back():t.isCommited=!1}).catch(function(t){console.log(t)})},getBiztripType:function(){return this.$axios.get("/mobicampus/biztrip/v1/getTypeListBySchool").then(function(t){var e=t.data;if(200===e.status)return e.result.data})},getApplicationDetails:function(){var t=this;this.$axios.get("/mobicampus/approve/v1/getApplicationDetails/"+this.$route.params.id).then(function(e){var o=e.data,a=o.result.data;if(200===o.status){var i=a.resource,n=a.process,r=a.application;t.curUserId=r.create_user_id;var s=i.start_time.split("+")[0].split("T"),c=i.end_time.split("+")[0].split("T");s[1]="07:50:00"===s[1]?"上午":"下午",c[1]="12:00:00"===c[1]?"上午":"下午",t.typeName=i.type_name,t.typeId=parseInt(i.type_id),t.dateSelA=s[0]+"  "+s[1],t.dateSelB=c[0]+"  "+c[1],t.textareaText=i.desc,t.site=i.destination,t.budget=i.budget,n.node_list.map(function(e,o){var a={user_name:e.user_name,user_id:e.user_id};0===o&&parseInt(e.user_id)===parseInt(t.curUserId)||t.approvalPersonArr.push(a)}),console.log("dataObject",a),a.cc_people.map(function(e){var o={user_name:e.user_name,user_id:e.user_id};t.selectedData.memberList.push(o),t.ccPersonArr.push(o)}),t.attachmentList=i.attachment_list,i.attachment_list.map(function(e){t.imgList.push(e.src)})}}).catch(function(t){console.log("error",t)})}}},v=(o("ndJD"),o("hghu")),b=Object(v.a)(h,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"waichu  page-bg"},[o("FormCom",[o("cell",{attrs:{button:"",title:"外出类型",content:t.typeName},on:{action:function(){return t.bottomOptionsShow=!0}}}),t._v(" "),o("cell",{attrs:{button:"",title:"开始时间",content:t.dateSelA},on:{action:function(){return t.SlideSelectDateShowA=!0}}}),t._v(" "),o("cell",{attrs:{button:"",title:"结束时间",content:t.dateSelB},on:{action:function(){return t.SlideSelectDateShowB=!0}}}),t._v(" "),o("cell",{attrs:{input:"",title:"目的地",content:t.site,placeholder:"填写位置"},on:{"update:content":function(e){t.site=e}}}),t._v(" "),o("cell",{attrs:{input:"",type:"number",title:"预算金额",content:t.budget,placeholder:"(元)"},on:{"update:content":function(e){t.budget=e}}})],1),t._v(" "),o("ccPersonCom",{attrs:{title:"同行人",ccPersonArr:t.gotogetherUserList},on:{addPerson:t.onMemberSelectC}}),t._v(" "),o("TextareaCom",{attrs:{placeholder:"请输入外出事由",content:t.textareaText},on:{"update:content":function(e){t.textareaText=e}}}),t._v(" "),o("ApprovalProcess-com",{attrs:{needArrow:!0,needDelBtn:t.canChangeProcess,needAddBtn:t.canChangeProcess,approvalPersonArr:t.approvalPersonArr},on:{addPerson:t.onMemberSelect,memberAction:t.onMemberAction,selectDirector:t.onSelectDirector}}),t._v(" "),o("ccPersonCom",{attrs:{needDelBtn:t.canChangeCcpeople,needAddBtn:t.canChangeCcpeople,ccPersonArr:t.ccPersonArr},on:{addPerson:t.onMemberSelectB}}),t._v(" "),o("AttachmentCom",{attrs:{imgList:t.imgList}}),t._v(" "),o("CommitBtnCom",{on:{action:t.commitBtnAction}}),t._v(" "),o("SlideSelectDate",{attrs:{show:t.SlideSelectDateShowA,value:t.dateSelA,maxValue:t.dateSelB},on:{"update:show":function(e){t.SlideSelectDateShowA=e},"update:value":function(e){t.dateSelA=e},error:function(e){t.timeError("开始时间不能晚于结束时间")}}}),t._v(" "),o("SlideSelectDate",{attrs:{show:t.SlideSelectDateShowB,value:t.dateSelB,minValue:t.dateSelA},on:{"update:show":function(e){t.SlideSelectDateShowB=e},"update:value":function(e){t.dateSelB=e},error:function(e){t.timeError("结束时间不能早于开始时间")}}}),t._v(" "),o("MemberSelect",{ref:"vMemberSelect"}),t._v(" "),o("BottomOptions",{attrs:{show:t.bottomOptionsShow},on:{"update:show":function(e){t.bottomOptionsShow=e}}},[o("ul",t._l(t.biztripTypeList,function(e,a){return o("li",{key:a,attrs:{"data-type":e.type},on:{click:function(o){t.biztripTypeAction(e)}}},[t._v(t._s(e.name))])}))])],1)},[],!1,null,"af9ea93c",null);e.default=b.exports},u8gS:function(t,e,o){var a=o("1Nvi");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("230f5960",a,!0,{})},wLqH:function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,'.buttom-operation-box[data-v-51e32140]{width:100%;height:.54rem;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:.54rem;text-align:center;font-size:.15rem;position:fixed;bottom:0;background:#fff;font-weight:700}.buttom-operation-box .keyboart-btn[data-v-51e32140]{width:.69rem;color:#88b8f8;position:relative;font-weight:400;display:inline-block}.buttom-operation-box .keyboart-btn .iconfont-approval[data-v-51e32140]{-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg);display:inline-block}.buttom-operation-box .keyboart-btn[data-v-51e32140]:after{content:"";display:block;width:1px;height:100%;border-right:1px solid #ddd;position:absolute;right:-1px;top:0;-webkit-transform:scaleX(.5);-ms-transform:scaleX(.5);transform:scaleX(.5)}.buttom-operation-box .keyboart-btn>span[data-v-51e32140]{font-size:.26rem}.buttom-operation-box .input-box[data-v-51e32140]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;padding:.08rem .21rem .08rem .18rem}.buttom-operation-box .input-box .inputContent-box[data-v-51e32140]{border-radius:.04rem;height:.36rem;border:1px solid #ddd;padding:0 .05rem;display:-webkit-flex;display:-ms-flexbox;display:flex}.buttom-operation-box .input-box .inputContent-box input[data-v-51e32140]{outline:none;-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;border:none;padding-right:.03rem}.buttom-operation-box .input-box .inputContent-box .sendText[data-v-51e32140]{width:.4rem;height:.28rem;line-height:.28rem;background-color:#ddd;color:#fff;font-weight:400;border-radius:.03rem;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;display:inline-block;font-size:.12rem}.buttom-operation-box .input-box .inputContent-box .sendText.active[data-v-51e32140]{background-color:#88b8f8}',""])},xPVP:function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,".buttom-operation-box[data-v-a60e7a92]{width:100%;height:.54rem;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:.54rem;text-align:center;font-size:.15rem;position:fixed;bottom:0;background:#fff;font-weight:700}.buttom-operation-box .keyboart-btn[data-v-a60e7a92]{width:.69rem;color:#88b8f8;position:relative;font-weight:400;border-right:1px solid #ddd}.buttom-operation-box .keyboart-btn>span[data-v-a60e7a92]{font-size:.26rem}.buttom-operation-box .keyboart-btn .iconfont-approval[data-v-a60e7a92]{-webkit-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg);display:inline-block;-webkit-transition:all .5s;-o-transition:all .5s;transition:all .5s}.buttom-operation-box .keyboart-btn .iconfont-approval.active[data-v-a60e7a92]{-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.list[data-v-a60e7a92]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;display:-webkit-flex;display:-ms-flexbox;display:flex}.item[data-v-a60e7a92]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;border-right:1px solid #ddd;color:#88b8f8}.item[data-v-a60e7a92]:last-child{border-right:0}.buttom-operation-box .revoke-btn[data-v-a60e7a92],.buttom-operation-box .urge-btn[data-v-a60e7a92]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;color:#88b8f8}.buttom-operation-box .input-box[data-v-a60e7a92]{-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;padding:.08rem .21rem .08rem .18rem}.buttom-operation-box .input-box .inputContent-box[data-v-a60e7a92]{border-radius:.04rem;height:.36rem;border:1px solid #ddd;padding:0 .05rem;display:-webkit-flex;display:-ms-flexbox;display:flex}.buttom-operation-box .input-box .inputContent-box input[data-v-a60e7a92]{outline:none;-webkit-flex:1 1;-ms-flex:1 1;flex:1 1;border:none;padding-right:.03rem}.buttom-operation-box .input-box .inputContent-box .sendText[data-v-a60e7a92]{width:.4rem;height:.28rem;line-height:.28rem;background-color:#ddd;color:#fff;font-weight:400;border-radius:.03rem;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;display:inline-block}.buttom-operation-box .input-box .inputContent-box .sendText.active[data-v-a60e7a92]{background-color:#88b8f8}",""])},ydf2:function(t,e,o){"use strict";var a=o("ULP5"),i=o("NMVR"),n=new Date,r=n.getFullYear(),s=n.getMonth()+1,c=n.getDate(),l={name:"slide-select-date",props:["value","show","minValue","maxValue"],data:function(){return{startYear:r-10,titles:["年","月","日","时段"],lists:[{d:[],i:0},{d:[],i:0},{d:[],i:0},{d:[],i:0}]}},created:function(){if(this.value){var t=this.value.split("  ")[0].split("-");this.lists=i.a.getData(this.startYear,t[0],t[1]),this.lists[2].i=t[2]-1}else this.lists=i.a.getData(this.startYear,r,s),this.selectTody();this.lists.push({d:[],i:0});var e=void 0;e=(this.value,0),this.lists[3].d=["上午","下午"],this.lists[3].i=e},methods:{onChange:function(t,e){1===e&&this.dayUpdate()},dayUpdate:function(){var t=this.lists,e=t[0],o=t[1];this.$set(this.lists[2],"d",i.a.getDayData(e.d[e.i],o.d[o.i]))},selectTody:function(){var t=this.lists;t[0].i=r-this.startYear-1,t[1].i=s-1,t[2].i=c-1},onConfirm:function(t){var e=this.minValue,o=this.maxValue,a=this.lists,i=a[0],n=a[1],r=a[2],s=this.lists[3],c=s.d[s.i],l=i.d[i.i]+"-"+n.d[n.i]+"-"+r.d[r.i]+"  "+c;e&&e>l||o&&o<l?this.$emit("error"):(this.$emit("update:value",l),t(1))}},components:{SlideSelect:a.a}},m=(o("Zvd1"),o("hghu")),d=Object(m.a)(l,function(){var t=this,e=t.$createElement;return(t._self._c||e)("SlideSelect",{attrs:{show:t.show,titles:t.titles,lists:t.lists},on:{close:function(e){t.$emit("update:show",0)},change:t.onChange,confirm:t.onConfirm}})},[],!1,null,"28b5e454",null);e.a=d.exports},ykn4:function(t,e,o){(t.exports=o("lbwJ")(!1)).push([t.i,".qingjia[data-v-30c5abe0]{padding-top:.12rem}.typeContent-box[data-v-30c5abe0]{margin:0 .1rem;border-radius:.08rem;background-color:#fff;-webkit-transform:translate(0);-ms-transform:translate(0);transform:translate(0)}.typeContent-box .row[data-v-30c5abe0]{height:.54rem;line-height:.52rem;padding:0 .1rem 0 .19rem}.typeContent-box .row.duration-box[data-v-30c5abe0]{border-bottom:none}.typeContent-box .row .left[data-v-30c5abe0]{float:left;color:#666;font-size:.17rem;font-weight:700}.typeContent-box .row .right[data-v-30c5abe0]{float:right;color:#ccc;font-size:.14rem}.typeContent-box .row .right.active[data-v-30c5abe0]{color:#333}.typeContent-box .row .duration-right.right[data-v-30c5abe0]{padding-right:.2rem}.typeContent-box .row .right .iconfont-approval[data-v-30c5abe0]{color:#b3b3b3;font-size:.17rem}.type-box .type-right[data-v-30c5abe0]{position:relative}.commitBtn-box[data-v-30c5abe0]{-webkit-box-shadow:.01rem .02rem .19rem 0 rgba(6,48,88,.13);box-shadow:.01rem .02rem .19rem 0 rgba(6,48,88,.13);height:.5rem;margin:.3rem .1rem .5rem;background-color:#53a2ed;color:#fff;line-height:.5rem;font-size:.16rem;border-radius:.09rem;text-align:center}.type-box .type-right .typeList[data-v-30c5abe0]{position:absolute;right:0;top:.54rem;z-index:9}.type-box .type-right .typeList>.typeItem[data-v-30c5abe0]{width:.65rem;background-color:#eee;color:#666;height:.45rem;line-height:.45rem;text-align:center;-webkit-box-sizing:border-box;box-sizing:border-box;border-bottom:.01rem solid #ccc}#durationIpt[data-v-30c5abe0]{outline:none;height:.32rem;border:none;text-align:right}#durationIpt[data-v-30c5abe0]::-webkit-input-placeholder,textarea[data-v-30c5abe0]::-webkit-input-placeholder{color:#ccc}#durationIpt[data-v-30c5abe0]:-ms-input-placeholder,#durationIpt[data-v-30c5abe0]::-ms-input-placeholder,textarea[data-v-30c5abe0]:-ms-input-placeholder,textarea[data-v-30c5abe0]::-ms-input-placeholder{color:#ccc}#durationIpt[data-v-30c5abe0]::placeholder,textarea[data-v-30c5abe0]::placeholder{color:#ccc}",""])},yuGO:function(t,e,o){var a=o("hL0j");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,o("BDYz").default)("d0d3f5da",a,!0,{})}}]);